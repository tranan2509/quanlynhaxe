CREATE DATABASE WORKSHOP
GO 


USE WORKSHOP
GO



BEGIN --create table
CREATE TABLE Photo
(
	id INT IDENTITY PRIMARY KEY,
	image IMAGE
)

CREATE TABLE Car
(
	id INT IDENTITY PRIMARY KEY,
	licensePlates NVARCHAR(30), 
	type NVARCHAR(30), 
	color NVARCHAR(30),
)

CREATE TABLE ImageCar
(
	id INT IDENTITY PRIMARY KEY,
	idCar INT FOREIGN KEY REFERENCES dbo.Car(id),
	frontCheckIn IMAGE,
	backCheckIn IMAGE,
	frontCheckOut IMAGE,
	backCheckOut IMAGE,
	status INT NOT NULL DEFAULT 0 -- 0: chưa ra, 1: đã ra
)

CREATE TABLE ImageCarRent
(
	id INT IDENTITY PRIMARY KEY,
	idCar INT FOREIGN KEY REFERENCES dbo.Car(id),
	frontCheckIn IMAGE,
	backCheckIn IMAGE
)

CREATE TABLE StatusCar
(
	id INT IDENTITY PRIMARY KEY,
	idCar INT FOREIGN KEY REFERENCES dbo.Car(id),
	idOwner INT, 
	idRenter INT, 
	isOwner INT -- 1 true, 0 false
)

CREATE TABLE TypeCustomer
(
	id INT PRIMARY KEY,  -- 0: chưa đăng kí thành viên -- 1: Khách hành thường (đã đăng kí) -- 2: Khách hàng vip
	name NVARCHAR(30),
	discount FLOAT DEFAULT 0
)

CREATE TABLE Customer
(
	id INT IDENTITY PRIMARY KEY,
	fname NVARCHAR(30),
	lname NVARCHAR(30),
	identityNumber NVARCHAR(30),
	gender NVARCHAR(30),
	bdate DATE,
	address NVARCHAR(100),
	phone NVARCHAR(30),
	idPhoto INT FOREIGN KEY REFERENCES dbo.Photo(id),
	typeCustomer INT FOREIGN KEY REFERENCES dbo.TypeCustomer(id),
	totalMoney FLOAT,
	qrCode NVARCHAR(30)
)

CREATE TABLE Speciality
(
	id INT IDENTITY PRIMARY KEY,
	content NVARCHAR(30)
)

CREATE TABLE Staff
(
	id INT IDENTITY PRIMARY KEY,
	fname NVARCHAR(30),
	lname NVARCHAR(30),
	identityNumber NVARCHAR(30) UNIQUE,
	gender NVARCHAR(30),
	bdate DATE,
	address NVARCHAR(100),
	phone NVARCHAR(30),
	idPhoto INT FOREIGN KEY REFERENCES dbo.Photo(id),
	salary FLOAT,
	bonus FLOAT,
	idSpeciality INT FOREIGN KEY REFERENCES dbo.Speciality(id),
	pass NVARCHAR(30)
)


CREATE TABLE Work
(
	id INT IDENTITY PRIMARY KEY,
	content NVARCHAR(30)
)

CREATE TABLE Contract
(
	id INT IDENTITY PRIMARY KEY,
	timeIn DATETIME,
	timeOut DATETIME,
	price FLOAT, 
	idCustomer INT FOREIGN KEY REFERENCES dbo.Customer(id),
	idStaff INT FOREIGN KEY REFERENCES dbo.Staff(id),
	idCar INT FOREIGN KEY REFERENCES dbo.Car(id),
	typeParking NVARCHAR(30),
	valueParking INT
)

CREATE TABLE ContractDetail
(
	id INT IDENTITY PRIMARY KEY,
	idContract INT FOREIGN KEY REFERENCES dbo.Contract(id),
	idWork INT FOREIGN KEY REFERENCES dbo.Work(id),
	detail NVARCHAR(200)
)

CREATE TABLE Receipt
(
	id INT IDENTITY PRIMARY KEY,
	idContract INT FOREIGN KEY REFERENCES dbo.Contract(id),
	dsign DATE,
	fname NVARCHAR(30), 
	lname NVARCHAR(30), 
	price FLOAT,
	idStaff INT FOREIGN KEY REFERENCES dbo.Staff(id)
)

CREATE TABLE PriceTypeCarParking
(
	id INT IDENTITY PRIMARY KEY,
	typeCar NVARCHAR(30),
	price FLOAT DEFAULT 0
)


CREATE TABLE ContractRent
(
	id INT IDENTITY PRIMARY KEY,
	idStaff INT FOREIGN KEY REFERENCES dbo.Staff(id),
	idCustomer INT FOREIGN KEY REFERENCES dbo.Customer(id),
	idCar INT FOREIGN KEY REFERENCES dbo.Car(id),
	timeIn DATETIME,
	timeOut DATETIME,
	cost INT
)

CREATE TABLE Company
(
	id INT PRIMARY KEY,
	fname NVARCHAR(30),
	lname NVARCHAR(30),
	founding DATETIME,
	address NVARCHAR(50),
	phone NVARCHAR(50)
)

END
GO
--======================================================================================--
-- Insert Data
INSERT INTO dbo.Company (id, fname, lname, founding, address, phone) VALUES (0, N'Shop', N'Work', N'20000101', N'HCM', N'0392889894')
GO

INSERT dbo.TypeCustomer VALUES  ( 0, N'Basic', 0.0 )
INSERT dbo.TypeCustomer VALUES  ( 1, N'Member', 0.05)
INSERT dbo.TypeCustomer VALUES  ( 2, N'VIP', 0.12)
GO
	
INSERT dbo.PriceTypeCarParking (typeCar, price) VALUES (N'Car', 700)
INSERT dbo.PriceTypeCarParking (typeCar, price) VALUES (N'Motobike', 500)
INSERT dbo.PriceTypeCarParking (typeCar, price) VALUES (N'Bicycle', 300)
GO

INSERT INTO Photo(image) VALUES ( 0x89504E470D0A1A0A0000000D4948445200000080000000800806000000C33E61CB0000000467414D410000B18F0BFC6105000000206348524D00007A26000080840000FA00000080E8000075300000EA6000003A98000017709CBA513C000000097048597300000EC400000EC401952B0E1B000023F449444154785EED9D077854D5D6F7A3AFD77BEFEBFBDD2257BD2A904E42420DA197905EE852A4D7543A4928A2A280F4A20828A82045918E541B1DA44A0F3194102090420B256D92CCACEFBF4ECE0993C99ECC4C3293049DF53CBF6792CC649FBDF75A7BEDB5F6DEE78C8D55AC6215AB58C52A56B18A55ACF28714677B3B9B5A0E76368EB6B62F38DADAFD3FF05FE000DC403D5017B8809AA01AF89B634DFBE7F02A976095674A1CA170A7EAF650B8DD5FC01BA035F8006C024740024806E9E02EB803524112380B7E029F82F6A00678D1D101E5D5B01A449516C79A18E535ED9E87C27884F700EB012BFB31D00032916C70157039EDC03F1D5E77C435ECE52B5AA54A0814C3B0E29DC1741007728048A965E5093808BA83972463B3B37A844A1528C2C6DED6815FAB03563CBB70351029D05C6482CDA001A684E7D810AC52090205302F021E916740011029CC52248228600738B8946B66158B8AA36D0D45F9FF0273C12320525045A002D7C112E054EB5F6F2050B4956B6A15B34B612A27F11A5803F2814831150D0798E7808F9BC33F503FAB115844D0C11CE5F3C867E55B7AAE2F0B3C2DB472B2B3B771A8693502B30A3A96E1B99683BDAA32F2451C03BC7620D7DC2AE51676A9DCA1C007F0A28DA8E3AB0A3C1D4C75B0B3FB1FBCCA2DB04AB9843B12FC13FC02449D5ED5E055467720B7C02A6516879AD2922ED313640151875745C63B3A486B14724BAC62B2C4460C915E3B05F8BFEE6CEFB05FA783AB3AA7C02B406A83554C90D8F0309BB161E13080D057C745858FE8DFB5CB491747A73CADCE2D17302642A42E7CCF5C38DBD967B7F7F589991A3BBA5A6C38B7254C6E9D55F44A6C64183A6A102BFEDF201CFC0654815E6DC841D0C922EC6BD8829A84344C52B2B3BDBDF4CABF6BBF27FA5F73F3567060EED8C8B01368C340F0CFD8613084F042AF66151D4107317F0521603FC805346AC840F2AC57DFA0D2F87D3767676ADBDC9306F76C4FB32646D0D259D1B46CEE58BCC6D0DC494369F8C0AED4CEA725356950975C9D9CC85E360A5179E585EBD3BA49138A0E1B4C68470ED80302C08B406EB5550A151F19FE1C5E9DC032F01070A711460F45F4E9456EB56A093B59813B3BD0AB397DB370229DD8B998120E2CA76B475751D2B1D54F39BA9A2E1FFA9ACEFDB294F66F9C4F6B16BF47D1E16F53DB168D25C3614330A767E0B21ABABBD38841FDA5B6C83C004B81C3D841036D62C3FEE4DE001D01E54BA3BE3FF81DA8415187B101F4ECD85E72E3A24E66781407B46946BBD7CE96949C7864155DFD75A55EF87DC938F0D92BF83DEEC04ADAFECD6C1A31A40735F3A82F4D1785D384F87AA6E00EC38DE8DB4B6A8756BBB88D71A007F8737A030EF2622387B00154075F802740BB938AF06FDD5AEFC8E4BFB33BDFB26C8AA45491C24B23114670377E1B3DBCBA8BD22E6EA5D3BB97D1D239E3A8438097A43C435EC190C7707170A4416F77D3350085476021F82FF7474CD49FC41BA0C16008BBFCA6E057506CD46B131D3E845A356EACB7A35D1C1DE993C9C385CA3586C423ABE90E147FFFD20E898C2B3B25124FACA55D6BE61479855AC81AD82B14521848720C11D8B645A9DE89DFEBFB56677D06C070DB39DE69F4CE1004BFE17F706F808682B0FFC16B5F701D883AA588D108001BD7170780AC080EF84EEC5C64D0EDEB43D700141E5CDE59E815E2BEA7D37B96D1774B3E8431BC4D21BEADA498C1B775339AF64E24FDF0DD5C6A54D75DAF813A81B73BB42FCD0014AE802E80FB46EEAD3F9870C3C0DFC078C0C190A8238AC101540304526203A849437A7590023E91728D419F0168C31E818D213D7E2B25FDB69E128E7C4B578E7D47777FDF46C967375197601FB2AB5EB344FD14BA0607196300CC5D300C704C24F7DA1F44B841E0FFC01C900D441D500CEEB4A103FA525D5757A10170B0F6F98C3152302752AE31186300DAB06750507E9F33697889BA2970BD3BFAFB196B004C26F810FC2F907BEF19176EC8D888D07FE095031E29B73706EEB4C8BEBD118CB9945804E28E6D58C78D7E5E33AB4CC19F82A906A00B7B87DF7EFE8A9A224E101929FF2DC4C75BD8BE52E035835980078CDC8BCFA87003E4862C027940D460216C00D21A8073C9350076FF5DDBF9D0853D5F408962E51A43790D8049BDB085FAF768279C06D80082DA7A09DB670015980D9E5D4FC015077F0773013748D450BDB00184F7EE49B59D9D4B742CAFE5B3FB2FCFE867CC6100195776D11A0489B59115E8D6930D20D8BBADB07D46C0DEF203F0ECC5045C61F00278171835E7EBA21880AE07E0859F364D1BD191AD0BA0C0CA37008E032E1F5B43FE6D9A4B9E49BBAE659C02B4C902C3E5CC49EEDD2A2E9CCB8E0D1BCC79FE209001440D338864007AA68069E343850A3515731800732F6107BD3B7A508938807FEFE0E74B8881846D34927BA06BF4F091D2C0AAD2C21594690D9281A84146210A02B9435B366E4807377F5C6EF7CF98CB00781A38BCFD336A54AF4E3123E07ABF151C28B545D44613B8069A80AA6D047205ED016F818A1A6234DC6943FBF7A13A2E9C063E1D551F8D33CFE867CC65000F2EEFA0DBE73753AF2E412582C1EEED43CC6100CC41C04BE7726F5731E18A018E5A570151034C82DDE6F001FDA85E6D37695449A3DFD37CA39F319701309C127EBDE05D69795A513EAF55F4EAD4C15C06A0018B0107D672AF5711E10A4D08930E720C051CB8881A603223070D40BEFFD4AD7E3066A0B483275666A151282B83C60488C61A00077AF712B653FAC5EF8B7ED7FD4C06FE167F78B5B454AC9C31E06CA55FD72EE6320086178A7A8D8DAC4253416CA8A478A60E4804A28A97093E0CC27B011C5D377477A31FBF9D89D15F72E58F957D62FBA7F4E1F06E34A4732B9A19D39BCEFCF499412330C60058D9BF1F5A49D3A27B53540F6F5A3C25926E9C5A2F34823BF1DB68D8A0EE64276703D26E600FBDBB816585B7CD6B019B1111FD652D54A2704500BBFE754054E132F3EE8808F26DD98C6CDFAC415D4378E1E74B284D5789ABE8C2EEA514D5BD2D35B2AF460D6DFF4D9E0EFFA1B18342E8E2BE2F8B7D56174306C04ABE716A1D45BDED431E762F4B6537767C85A68CEA4969715B4A7C9E83C1AD2B674A5BC9ECB5F835B25F6F731B00F325A8FCA980533EAE04E80DD83D892A5B26260C0BA75DAB66D3909EEDA5C06ADEA4A1C2B99F3DC2CEAF3FA4D66E6F4A06C0CAE7D7B6756BD2EE35D3851E43C19001B0427F5E33835AD67EA358D97E1E0E74FAE7A5D2FBDA9F6783B974E45BF269D91475AE41AD9A78D0F28F27D184A111C2369683C7808FCED98CADCC2D64AE00780D9C04A28A968998F021346BE2688ADFB79CC60DED2DADB26DF96AB270E38715BC6ADE186AEAFC9AA42085E62EFFA5EFBF78AFD4CD22630C60E5FC6869D46B97DD0AC6C6C128EF12EAFE0FEF1A86F6E94C35DFA82E6D1F9FDBB79266BC33466A93A8ADE5E0007805C8DAA86091467FAF016C00BCDA570044952C13DC592BE64F92DCFBE269A3A869C37AB47FE33CBD1EE0C75553C9AB4E8D62A3D4A7BE1DED5D2B8E19148C3180BD1BE6526BF7EA45657BD855A3C0C64E740ED391AE0750FE67C99C71D21430B06707BA7576132D9E3E91A2C3CC6E00BCB7121A1B053D548617C0C5195BC04189A88265860D60C3928FA4C39C7CDCAB45A306A5EEFCC5EFFB8AA2FB07492395E7EA264EAFD2640484090796093FAF604C0C70EBEC468A1918222BFF656A56EB35FAE4FD2108F8C4FFC7067064E7E7D40041EBCCF7864AD9C397732659C20098B3A0E2D706F882D185063019E83DD25556D800BEF9F44349E17BD7CFA5E68DEAD3779FC19DC320C48A5C2545FD4B3F8AA209A11D68F9AC11526068300B807728CD00183682C4E36B68C5BC68FA704477DAB8F43DBA7D6E93300B60D8008EEE5A82ECA52EADFB628AF4B7CF66BC6B290360CF1B35B6A2BD002ECABC092E0251C5CA051BC082C963E9D2A115747CC72269F3E7D3A923F51A00C3CA662E1F5E21198E21E5333C3DF0A1505D25EAC2CA66EEFEBE5D52B03EE5330FF1FEFAAFA69267BD3A7470EB22640B5B69EEFBB196880114CE80D781AC1D0B0B5F486614C807A24A958B98F0509A1C339CCEFEFC85B4E71FE2D392C646F5122AB13C4806F0BB610330055E119CFE6E14B569E6490947BE4156F01D7D306698D426515BCD006FB5F7047CF046D69205852F04FE058E005185CCC2B8A830CCFBF3A49B397A750EA0813D4228E160D9CFFF89B08401B077888DEA435D82BDE9D6B9CDB475C55C61FBCCCC6EF04F206BC982C21701BE80CFB58B2A6316D8657EFC412C5DDCB78C460EEE46BD6104BF97E300A8084B19C098885E128927D6D1CC8916490175E16DF7E640D69285842F101B1EC6073D56025145CC0A7B816D5FCFA2851F8DA4F03E1DCB75025884A50CE09D9103E8D3696368C39733696CA4B86D1660564C44E8F37895B56501E1C201A71D9780A8126685E7CDF74745D1C62FA6D2EE7573E80A023C9122CB8A650C60079DFCF94B5ABD680A4D1C1169C9B95F9778F00690B5656619D7AFB76200DD009F5C1555C2EC70074E1A3D947E45446D4C646F0A96F200E7F6ADA2F751E70A70FDDAF02EAC1F90356666E182019F4DFB16882A6031D808367D39FD1931801DB469D9EC8A56BEC2ACE8D0D0E72CB22680C29957C179F962150677E6A753C6220BF85AA8C8B2620903E02D610B2EFC18E214F80F90B56646E14201DFD059E6839E65853D00AF0B9CF98957F7C4CA2C0BE6360076FF374E6DA4E91346579607B80F3C80AC353349B4F4E816C900F8BE3ED1852DCE84A1E1B47FE302BA66C669C0DC06C0A782CEEC5921057FA2365400BC342C2D0A8D8B8A90B56706E102C15FC06620BAB0C5612FB0F6B329424596154B4C01EBBF985959A35F61516C6438D241333E940A8532D500AF3B8B2E6A71B853674D1C43717B4BDFE1D30F52484E23B5E03D83BBD2AEDE761DC4CA3544CAF92D34FFC3B19535FF2BF0D90C7EC896AC3D330817069CC12D20BA688530717804FDFAFD4293B301DEF64DBB7490EEDF38034E4BDC030F6E9EA1CC3BF1947D37A1188F6F9D8042F56FF888E0F9FFC2FED5F4DEA828C95B89EA5F41DC040E40D69E19840B036D80DE47B954146B164D162AD910E9570E93BA209F0C89A640458F938F41A9A67B82B54B6654B6FB677889BE1990B56706E1C2001FF936FBDEBF29F0C8FA307A181DDF61F8C4AF2EEC05EEDF3C5BAA11680AF22833ED3C9469FAE8E75DBFA9E346560503E093429D81ACBD728A74F4ABF01C3ADFDF2FBA60851203164E1D8F58E02B9353423682D4847D94F3289DD4F92AD268D48560D4E765DD9547BEE9CAE75DBFA5B3DFAB6CD7AF0D3F64D32636CC0C81A05450E10AE00620BA58A5B07CDEFBF4FBFEE5261B8114FC1D5F4BC9E77650EAEF7BE9D1CDA3F4F0FA417A70E54728D434B7CFAB7EA971DFD3B78B3FB2C4D1EFF2302776C860F3AC08A23086EF51FF592EBC4AC01DBEF2E349653302C01B4BC5B300B192F5A1287FED92E9D2AEA5A88E95C87AC069BBACC572081702F8291FFC4837D1C52A0D3682E5F3DEA38B480DCB6204655D0760B77F1B291F8F7C563E4F4BA2FA5522FCE839F33C5D840B012F035E67165DAC52E1FDF6CFA74F908E8F991A1896C50058F9D74F6DA065F33FA86A6E5F1BBE3BDB3C2784B810C01B0CE780E862558279EF47D3D16D8B4DF204A61A00BBFDF843DFD2A7532708EB5085380D78D0CA5A2C8770218077012D7202D85C70FA352576B8748EF0EA61B1C27531C500F87CFFAFDB97D2B4F1A3AA42AA67081EACE6D915E44200DFFEC5274E4417AB32F012ECEC7746D1F12D9FD025238E8FB101E8BBC1A3088CFA74047B677F5842B3278EAAEC655E63B900CC73DB181702D803F013AE4517AB32F0C89CF3DE183ABA693E1D5E379B2EFCBCA4546F60C80078D45F3FF11D1DDD388F0EAD9D83B2A39F85D1CFF01D4366F500BC11C4858A2E566560E5702C10BF6F199DDCFA09ED5B3D8D8E6F9E4FBFEFFBCA64034839B709A3FE73A98CA31BE651D289B5B460CAF867C503F037AD986743880B011C511E07A28B5519D800E6C200F8F430E7F9A7B62FA4BD2B3FA2FDDF4CA7DFB62DA084FDC577128B0C00913D47F7ACF8D4F39B296EF79774E8BB59B4FBEB29746CF3C7947276A37487CF27CF8E0170CA6E9E278D7221801F46B00F882E56656003F878F2044A38F854C9E77EFC8CF6AF9E2E29930D813D42DC2F4B8B6284B40B5B246E60849FDDF55991E2F7AC984A67762E96DEE3E83FEDE2365A30D52277F95A825DC03C0F98E4DB8D00AF2A6D950BAFB2B0016C5AB39A6EC4ED87729FAE09C4EFFD928EAC9F43BB574CA15F964F96BCC2816F67D0E1B5B3A5F99D5FF7AD9A26BDC71C5C331306B242EBBEC19D947EED37FA6AE1273000E93B80AA3A9FC7869BE9D1F3FC40A209C3C2F8C18FCBB52E5025193F2C928E1C3A4869A9B728E9CCAE220360A4EF0BFAA17084F3E85694FDCBB2C2571EF56C14E77EFC9C6E9FD958140B3077AFFD4AE9A9B769C7E64D5579F1479B58FE06B618737C27D1D8F1A39469E03DAD0B5449268F8DA1F8B8384A4B4BA7DB3713E9DAC9CD507EF19B492E1D5C4E1730059CDCBA807E8557600F706AC72218C84A49F11CF92BF10073EFEA5E4ABB7D9DD2D2D3E9D48913F4EEA8E1C26B572178CB5E3A176836E1C2407B50613784188B3C223543FBF7C98B193634F3EAD5AB9AB4B4344A4D4DA35BD72E52E2B1B5258CE0AABC5AC84BC79CE32B4AD756BCA4FCCB3F51FAAD2B282B553280B367CE68C2FBF5510D1BD08F0F5F6AAAA837E01B44BC81AC3D33081706EA01FE560BD1452B1C7E9024E67C7564DFDEB9416DBDB2EABABAE6F9B4F12A88BB70011E800D205522F9F26F50F837C50D40A6D495C0CBBB28FD665C5139E9308083070E50A3FA0D34F5DDDCF2437CBC73A2FAF52E401D345C17DDFA5522E9C01DC8DA33837061801F4260F6C7C19405EEF46103FBAB3A0406DCAFE3E29AEB686BA7E16709366EE841C78E1E9594A5282E35250541E10128BCE44651690670E7FA6FF8FF94A272EEDCB9435B366FA1DACE858F80E36BD675712DF06BD53237125E21A6F0499EC2FA563071B11161AF5AE25430A782BFC817A914A279C4F7EFA7EADEB98B2AD03F20BB762D976CE529A2FC5AC7B536FDF4E34F92B28A0C00A4DCBE4949677F30DA00EE261E86E124172B838DEAE379F3A5C7BFF2F5946B0275D3469E8F7A74E9921335A05F1E7B2551DD2B908D311161E6FD8E8198F0C136EF0C1BC646F089D6852A0CE4DE6ACCBDB95D3B7556050705AB03FC03D51E0D1A6642096A45194C2D07475AB7766D0903E078400A0A7FDB02C53F8D07440670EFEA1E047D493AFF5FC89851A3A5E7FF695F9371B677C86BD3DA2B372438A4A05BE7CEAAC8FE7D556CACA2B65400C3F85BD76104B2F6CC242898E1871396E90B20CA02145F10D6B777F65B1D3BA98203A1F880200A046D5AB5C97276702CF16DE23C22172D5C283000064161523C251E5F576404BA0620057DC99705FF8B5822399906F4EB273400A6AE5B9D6C7FBF8002AE1F1B291B6B78BF0A37047E58A71790B56646E142811DE067D78B2E6E36A2C3061784F6E99DDD058A0FD2523CE3E7EB9FE7EE5A3B5BA4048E0362468FA1DBB76F0B95C8245F3E4589470B83C2E206C041DF05E1FF705079EDDA35EADCA1A35E03C0D450D0A2598B6CD451C3F5E43AB3D176EDD8298F33870A3284ABA00690B56646E14201C7013F02D1C5CB0DBBFAB0BE7D78C4E7EA2A5E46D3D8C3F3093ABC98EB5760E574EDDC4552967626500C0E0A2F160685DA067027E924DE7F1AF469C3655DBC78917CBDDA96F85A186D1093E4FAFAF8E569D7B9C8103A75CA8BB0BC47F80EC1A865BE6388A34A2E184403B336820327740EE6F8E2AE5E97B66DDA66D7727052893A9F61E5F8B6F5A678284BAF018094DBC95250281940FC56047D874A047DDA7000F8DBC9939A669EFABFC656463250D455AD5B77C510BA616AE018813319515F94037E629BB400141369A1EF21E6C2811B4801A24A9804AC553D14E95CF7CE9D73316F16E8533C83F935BFAE9B7B1677B24EA717C1CA69EAE949274F9C289E0A96A03028BC711ACABFF4B3DEA04F211D31C5DE3D7BA9BE7BF1AF84118140340F869A2B6A03C36D0C090A2940D6A0422ACB377198CB10F8B63D17206BCB02C285033E6DFA131055C2583423060FCCEBD9B56B363A231F9D22CD9BA5A069DAB8C9639E67459DAEC0CAA9E7E64E7B76EFD613083E250D245EBB44894997A59F459F51E0B2905D14B83A95FC0A3B019AFA75EA6607C8016169B443D6D0BB5BB7DC914306F2E82DAF21AC05FCD5BCB2B62C205AD3402830E98B201546870ECEEFFF768FECF621ED78AE34A478096F2FEF1C1747675EF0117578315C1C9D68D3868DA51A002BFC4A722AC5EE4FA6917B9229E166E1DF449F65D89B4CFF689AC6D0E85760436DD5A2250784C2F6E8A0E9D0AE7DFEA05E3D73C620F815F59911F0770C4AB783C5449A39FDD315BE08E0483301882A2324263C94E7F91C44D2EC1E4BCC91FA40CE5F801155AAEBD7E58B254BF51A002BFA2A943F16CA6FF85D12350031FB92258328CD08460C1DA6D6970188707371CDF1F3F1CB17B549445060909AD35D293E30DD1BF0713D7E74AFAC250B0ADF6E14131EC6CFA333FA5EC1914306E5F582BB0FC6DC57DA3C2F40D3BC69F3471851F9A24E16C181E0BBEFBC432988F675952829FF562A8D93955F5F3600FE79C281644AC47B2223B879F326F5EDD54B638A01007513CF2659DC069D36E945890F302DE48C1A32C894C7F04E78CBA1BE740F6785082EC83404A9720584F0A8E7B4AE63BB0E2A34D0E88E50F0F1F6CD7575AE6594EB576025F5EAD183AE5FBF5E4C898AF2C743D10DD73E553EC33F7BE06F930E213BD03102CE26121313D51DDBB537C90330988E5498BEF40684A5A0E9D4BE03A78DECDA0D7983DBC0BC9B3F86842F065E047A1F19C7733D2C19A33ED8603024825D7FC37AF579B9D768D7CFB00708F0F5A384848462A9E02D44FE1F1CBE556CE46BA318C1FCE3B729059FD53680B8B8384DDBD66DD4A5AD01E841D3A06EFD4C5EBA16B5D110EC0DFA76EF9E6D2036988F91FF42858D7E457061869F4FCBDB8FC52A357CD00055D78E9DD8F24D1EF50A2D9BB77CE264EF60B4EB5770A8614B2D9A34D59C397D5AA3A482FC9A959D4D9F9DCF9094ACAB7C85466BAFD3BACB8F283333B3C878E4358082268D3CD5C60681DA7040D8BA65AB1C511B8D44DD0D6932B226D19490061A00592B15287C51C05EA0D87383A306F4CB85BB64972F6A8C51F0E8F7A8DF20D350DA278295D4A04E5DCD81FDFB250360B2A17C9607B9053478772AD55B5352F9FCB71107D2E8914ACD8F8AA0274F9E4846C0FFBF67CF9E82BAB5DDCA62001A671871630FCF87685799BC80024F09430BD70DB40D606E4C44D80B081A65AD54B0A0020C5B203F97461AF948695426067A42FCFD02D46D5AB5512103C84127B221183D15F09EFDF66DDBD577EFDD2B52BE2227D273C87BF34DAAAF6504FCB3DF969B74FE5EAEFC29988046438F1F3F96B2890DEBD767633E37652AD2D47270CCC714F6C4ABB557AEB249541EB84FD908B43C4112A80D646D5482F0C511E8714630233A6C483EBB2A7328BF88C060F6066AAF365E790DEB35C8E24EE5CED5E9EC12C0736856AF5C55A052A964753E95020DD182B30F348805348A01F0B4B022FEA1468DF7B4858D803DC1B4A953B330FF0BF71F74D0C050F21B35F4C86AEBE5AD2A9CFB83C56D2B233DBABCC5FB09EC09A2A387463CC7873F2B55D808260C8D787350AF9E8782A13051A5CB4FA12120A2CEE3CEE54EE6CED6E9FC2238589B397D7A2674C8FEBC849CBD9B9BDB7CC3F57C0EFC18FC5C70EE5E6E9EFC76315143460E1B9E63FB6675E1B564D42E4ECEAAC68D3CB3BCDBFA70EE5F2E775F1ADCC7A17D7B1F9C383CF2BF953AFA1519133AD8C6B18E870D22D60EA860866E852D80C6079D8CA02CC7D5C9399F47BBAE42385D0B1D34F8495E5E9ED0007EB89179AFD1DAA402C50378AEBBAE3E9C92FDD4FF6B0997D1AF779F1C510A886BAB31DDE4366DDC340B29ABD12B9BE524A37D48BB2097FA9E36A34307C95AA86441A59817C16772252B028D8FB74F5E833AF54AA48AACAC2E1D3AE6C37D8B0C4033FFCC830775D724A915038017506F497C9223BF5F4C50461E82DA5C8101A811A83EF1F5F12BD31A4719E1EBCC0C0808E4BE967BBF8A08570854074781A8F266C5CFC72FB751038FC7725C504C393C05F87879E521802B90F5582498E70B620FA767D65D73AD2808E40C60F6A9FB19FC76E1A79E0ACAC8F36EDD2657B406C0D7F66CD828D3CFD7DFE825DF727208BC09E45EAF4282E0CF26A8D008DA8214206A803950B76ED9FA899B8B2BEF0F0803334ED79A376EA2BE9E9454C200720B3405480573E1018A0C807F0EDF9B9A85F74A18405252526ED3469E79A5A4806A77D7DAB9C85838D7B7A427B80D5A01A9AFABA470E50203839EC76B14E075705143CA4CE1A86FF8980F610A1451042BABBE7B9DFCF3E7CE9708EC3272D5795D76DECAD15E0BE09FDFDA794B85F74A3C45F2FCB9733975DDDC4A330089426FE0F1C442DE80FB7270A07FD07378957BBB8A0A57109EE06F785D08CA9DFFCA181CF5BA2038D3FC7AE870090F70EB49BECAEFFB9B79BAEB00FEDFDFCCC77B250C60F72FBF3C44D661EC829425BC01F7E10CC07D2AF7721517AE28A806360251A38C06A35E65CCA8D78523F4ED5BB79588ECE3EEE766B7D870234F7B3F807F6EB9E146FEC5FBB9BA0B079AC50B17A563FE376945D28CDE808D68357819C8BDFB0C88B7AFBF620435C16E206A9C41F8544D3DF73A25CEFF1B83438D9A9AAF972F2F31A27FB89E79CF432B0554E054F050C95450F3CEF80959B66F563765155041CD9B59BCAC2D6A9B91FC0838B0B609F26F27F7EE332281018120988DA016E0E855D44043F021CB321900A76D50DE235EC89195C9C2296086760AA8204A050B2061838764DABD69DA367021F6EAE64D9B171D132F03FB8123E0B84AEED5674C385A951A1010E4060E0351434BC5D7C737CFD5B99649EE9F6103E8DBABB72A3737B768819753C0189D145041940AE6E4E414BCDDADBB4AB4086408B75A2E39E5980258F92E411840C8F9E5DE7C4645CB085CC05E206A706994C90B70DE1E121894F730E3615120284A0115F86F617B53B3B553C18C8C0C55A0AF5FB6680DC0003CFA4D3A0DA4C52FC0A9D07B3EE3CA57040D4266204D077660333069ADDCD71B5EC0C9D9242FC04AF36AD9AA203525F5A942910276D649011544A960CAED94FC56CD5BE4996A00B579F4EBDC206204DC27EB400DF0C751BE22817E2152A3D0B857002F199B72544AE3E9D1C8242FC0797BE3861E05572E5F2E5268B220055410A58297122EE578D4ABAF32B406A003467F3353473FA78DF34135048D36ED8242E45EFB030A1AC9BC044681BB40D42125E0CD1653BC002BAD8E6BED8253A74E15291429604E8B0DD78BA580450600901E164B054F9E3891E3EEE26AD2A9241EFDBAB78719E00E1806FE17C8BDF40797424F10F8021AEC0F4E0363468B86D7DDD1C9467B013EC4B177CF9EA2D5407D29A082940ADE2E4A0535EBD7AEBB63E2A92475B326468F7EFECC29E007B82FE4DEF9930847B7FE81D27A810358060C2E1DB31770312D16506FDAB04119D14801EF0B5340054E05373F4D053533A64DCB400660B4C1F1D6B091A33F13F03468D7213044DA43F9D30A3A8161F7F736B8004A0B10357C20049D6DD4C20C076F0B172C6085F2691FBD29A0020782B3E45450A3D1A8470D1FC18B40C2B20560F4373534FAF93D6E630FF07720F7C29F5C780404054A1B1D9C25CC057A63039FB63E467B01CEDF87450D7D545090AF2E2D05545052411552413E08D2BF4FDF6C63D700F8FE0503A39FE77A5ED3B70BF4435BFDADCA2F21F29A011F76680A38257A0C743B52D3A881715E8095D7FDADAEF9D959599A0C95FE145081DFEBB2F356EE43953A3F2B3333BF53FB0EA2832022D47C2A88EBA6535786DBB006709BFE02E4D65A452881BC8F10282D8270A6E00378DDE01128EA54C90B381AF6023C05F8FBF8E43DB87FAFE0566681DE14504149056F6715E4DFBF7B37CFBB8D578E316B00AE4E18FD8547C2B415CF47C1B9EEDC8697783917235F6EA5550C0A775680640841FF07F82004078A7CD0846304788186FC989852BD002BAF65B3E6EA945BC9EAF88C3CBD29A082920AE2B3AAE41BD7554D3D1B1B3C070030FA8BEE01E4BA711DBF005CE797FCA1F860EBA82FBB0476ED6E13E81F6813E01FF4577428EF298C04C7BDDB7ADF439A57AA1760E535AC5B2F3F213E5EF553724EA929A002A78247D27255F1172EE4D47373376800AE4ECEB9C84EEEA34E2700AF6DB821A67931888DD7DB576E8555CC22C1E8D4E0A0E0E7D0B9D502FC029BD776769902259C060F80305D737371D59C38762C7FC1F947A5A6800A9C0A6EBD9E9D7370EFDE4750AEBE3500FEFB7D70A26E6DF709507A0B502DD03F00C1DD1F6C09B7AA8A93AD1DB07D1E4AF80FF00403C16A7011DC01D213446BD93B6876ECD89933FEE8FDACD25240050E04E79CC9C858BC68512A463F2B9AA7991C900E2E8015A01FF0002F3BD9DA731DE45A59A552A496839D4DF5576BDA38DADABF0865BC06EA802010E658D3F6E3B51B36ED0ADF7FE7183CC02528F9264801E9E0AE0CFFCC7FBB81CF2444EC4B3B3CE983C9DFD77CE3CD392863080800EEE015473BBBBF38BC5AC3C6D1DEAAF42A2DFFB07DC9C6E9753B9B37AABDFCFCB69FF6FCBDDB0F29FF867B7F1D4AB6032EC01DD493E19FF96F76F000AF2315FCF747B33FFEFB5F6D6C9E7778C3D6C6F1B155D956B18A55AC6215AB58C52A56F9C3888DCDFF07FF1CDA5CF22675400000000049454E44AE426082)
INSERT INTO Photo(image) VALUES ( 0x89504E470D0A1A0A0000000D4948445200000080000000800806000000C33E61CB0000000467414D410000B18F0BFC6105000000206348524D00007A26000080840000FA00000080E8000075300000EA6000003A98000017709CBA513C000000097048597300000EC400000EC401952B0E1B000023F449444154785EED9D077854D5D6F7A3AFD77BEFEBFBDD2257BD2A904E42420DA197905EE852A4D7543A4928A2A280F4A20828A82045918E541B1DA44A0F3194102090420B256D92CCACEFBF4ECE0993C99ECC4C3293049DF53CBF6792CC649FBDF75A7BEDB5F6DEE78C8D55AC6215AB58C52A56B18A55ACF28714677B3B9B5A0E76368EB6B62F38DADAFD3FF05FE000DC403D5017B8809AA01AF89B634DFBE7F02A976095674A1CA170A7EAF650B8DD5FC01BA035F8006C024740024806E9E02EB803524112380B7E029F82F6A00678D1D101E5D5B01A449516C79A18E535ED9E87C27884F700EB012BFB31D00032916C70157039EDC03F1D5E77C435ECE52B5AA54A0814C3B0E29DC1741007728048A965E5093808BA83972463B3B37A844A1528C2C6DED6815FAB03563CBB70351029D05C6482CDA001A684E7D810AC52090205302F021E916740011029CC52248228600738B8946B66158B8AA36D0D45F9FF0273C12320525045A002D7C112E054EB5F6F2050B4956B6A15B34B612A27F11A5803F2814831150D0798E7808F9BC33F503FAB115844D0C11CE5F3C867E55B7AAE2F0B3C2DB472B2B3B771A8693502B30A3A96E1B99683BDAA32F2451C03BC7620D7DC2AE51676A9DCA1C007F0A28DA8E3AB0A3C1D4C75B0B3FB1FBCCA2DB04AB9843B12FC13FC02449D5ED5E055467720B7C02A6516879AD2922ED313640151875745C63B3A486B14724BAC62B2C4460C915E3B05F8BFEE6CEFB05FA783AB3AA7C02B406A83554C90D8F0309BB161E13080D057C745858FE8DFB5CB491747A73CADCE2D17302642A42E7CCF5C38DBD967B7F7F589991A3BBA5A6C38B7254C6E9D55F44A6C64183A6A102BFEDF201CFC0654815E6DC841D0C922EC6BD8829A84344C52B2B3BDBDF4CABF6BBF27FA5F73F3567060EED8C8B01368C340F0CFD8613084F042AF66151D4107317F0521603FC805346AC840F2AC57DFA0D2F87D3767676ADBDC9306F76C4FB32646D0D259D1B46CEE58BCC6D0DC494369F8C0AED4CEA725356950975C9D9CC85E360A5179E585EBD3BA49138A0E1B4C68470ED80302C08B406EB5550A151F19FE1C5E9DC032F01070A711460F45F4E9456EB56A093B59813B3BD0AB397DB370229DD8B998120E2CA76B475751D2B1D54F39BA9A2E1FFA9ACEFDB294F66F9C4F6B16BF47D1E16F53DB168D25C3614330A767E0B21ABABBD38841FDA5B6C83C004B81C3D841036D62C3FEE4DE001D01E54BA3BE3FF81DA8415187B101F4ECD85E72E3A24E66781407B46946BBD7CE96949C7864155DFD75A55EF87DC938F0D92BF83DEEC04ADAFECD6C1A31A40735F3A82F4D1785D384F87AA6E00EC38DE8DB4B6A8756BBB88D71A007F8737A030EF2622387B00154075F802740BB938AF06FDD5AEFC8E4BFB33BDFB26C8AA45491C24B23114670377E1B3DBCBA8BD22E6EA5D3BB97D1D239E3A8438097A43C435EC190C7707170A4416F77D3350085476021F82FF7474CD49FC41BA0C16008BBFCA6E057506CD46B131D3E845A356EACB7A35D1C1DE993C9C385CA3586C423ABE90E147FFFD20E898C2B3B25124FACA55D6BE61479855AC81AD82B14521848720C11D8B645A9DE89DFEBFB56677D06C070DB39DE69F4CE1004BFE17F706F808682B0FFC16B5F701D883AA588D108001BD7170780AC080EF84EEC5C64D0EDEB43D700141E5CDE59E815E2BEA7D37B96D1774B3E8431BC4D21BEADA498C1B775339AF64E24FDF0DD5C6A54D75DAF813A81B73BB42FCD0014AE802E80FB46EEAD3F9870C3C0DFC078C0C190A8238AC101540304526203A849437A7590023E91728D419F0168C31E818D213D7E2B25FDB69E128E7C4B578E7D47777FDF46C967375197601FB2AB5EB344FD14BA0607196300CC5D300C704C24F7DA1F44B841E0FFC01C900D441D500CEEB4A103FA525D5757A10170B0F6F98C3152302752AE31186300DAB06750507E9F33697889BA2970BD3BFAFB196B004C26F810FC2F907BEF19176EC8D888D07FE095031E29B73706EEB4C8BEBD118CB9945804E28E6D58C78D7E5E33AB4CC19F82A906A00B7B87DF7EFE8A9A224E101929FF2DC4C75BD8BE52E035835980078CDC8BCFA87003E4862C027940D460216C00D21A8073C9350076FF5DDBF9D0853D5F408962E51A43790D8049BDB085FAF768279C06D80082DA7A09DB670015980D9E5D4FC015077F0773013748D450BDB00184F7EE49B59D9D4B742CAFE5B3FB2FCFE867CC6100195776D11A0489B59115E8D6930D20D8BBADB07D46C0DEF203F0ECC5045C61F00278171835E7EBA21880AE07E0859F364D1BD191AD0BA0C0CA37008E032E1F5B43FE6D9A4B9E49BBAE659C02B4C902C3E5CC49EEDD2A2E9CCB8E0D1BCC79FE209001440D338864007AA68069E343850A3515731800732F6107BD3B7A508938807FEFE0E74B8881846D34927BA06BF4F091D2C0AAD2C21594690D9281A84146210A02B9435B366E4807377F5C6EF7CF98CB00781A38BCFD336A54AF4E3123E07ABF151C28B545D44613B8069A80AA6D047205ED016F818A1A6234DC6943FBF7A13A2E9C063E1D551F8D33CFE867CC65000F2EEFA0DBE73753AF2E412582C1EEED43CC6100CC41C04BE7726F5731E18A018E5A570151034C82DDE6F001FDA85E6D37695449A3DFD37CA39F319701309C127EBDE05D69795A513EAF55F4EAD4C15C06A0018B0107D672AF5711E10A4D08930E720C051CB8881A603223070D40BEFFD4AD7E3066A0B483275666A151282B83C60488C61A00077AF712B653FAC5EF8B7ED7FD4C06FE167F78B5B454AC9C31E06CA55FD72EE6320086178A7A8D8DAC4253416CA8A478A60E4804A28A97093E0CC27B011C5D377477A31FBF9D89D15F72E58F957D62FBA7F4E1F06E34A4732B9A19D39BCEFCF499412330C60058D9BF1F5A49D3A27B53540F6F5A3C25926E9C5A2F34823BF1DB68D8A0EE64276703D26E600FBDBB816585B7CD6B019B1111FD652D54A2704500BBFE754054E132F3EE8808F26DD98C6CDFAC415D4378E1E74B284D5789ABE8C2EEA514D5BD2D35B2AF460D6DFF4D9E0EFFA1B18342E8E2BE2F8B7D56174306C04ABE716A1D45BDED431E762F4B6537767C85A68CEA4969715B4A7C9E83C1AD2B674A5BC9ECB5F835B25F6F731B00F325A8FCA980533EAE04E80DD83D892A5B26260C0BA75DAB66D3909EEDA5C06ADEA4A1C2B99F3DC2CEAF3FA4D66E6F4A06C0CAE7D7B6756BD2EE35D3851E43C19001B0427F5E33835AD67EA358D97E1E0E74FAE7A5D2FBDA9F6783B974E45BF269D91475AE41AD9A78D0F28F27D184A111C2369683C7808FCED98CADCC2D64AE00780D9C04A28A968998F021346BE2688ADFB79CC60DED2DADB26DF96AB270E38715BC6ADE186AEAFC9AA42085E62EFFA5EFBF78AFD4CD22630C60E5FC6869D46B97DD0AC6C6C128EF12EAFE0FEF1A86F6E94C35DFA82E6D1F9FDBB79266BC33466A93A8ADE5E0007805C8DAA86091467FAF016C00BCDA570044952C13DC592BE64F92DCFBE269A3A869C37AB47FE33CBD1EE0C75553C9AB4E8D62A3D4A7BE1DED5D2B8E19148C3180BD1BE6526BF7EA45657BD855A3C0C64E740ED391AE0750FE67C99C71D21430B06707BA7576132D9E3E91A2C3CC6E00BCB7121A1B053D548617C0C5195BC04189A88265860D60C3928FA4C39C7CDCAB45A306A5EEFCC5EFFB8AA2FB07492395E7EA264EAFD2640484090796093FAF604C0C70EBEC468A1918222BFF656A56EB35FAE4FD2108F8C4FFC7067064E7E7D40041EBCCF7864AD9C397732659C20098B3A0E2D706F882D185063019E83DD25556D800BEF9F44349E17BD7CFA5E68DEAD3779FC19DC320C48A5C2545FD4B3F8AA209A11D68F9AC11526068300B807728CD00183682C4E36B68C5BC68FA704477DAB8F43DBA7D6E93300B60D8008EEE5A82ECA52EADFB628AF4B7CF66BC6B290360CF1B35B6A2BD002ECABC092E0251C5CA051BC082C963E9D2A115747CC72269F3E7D3A923F51A00C3CA662E1F5E21198E21E5333C3DF0A1505D25EAC2CA66EEFEBE5D52B03EE5330FF1FEFAAFA69267BD3A7470EB22640B5B69EEFBB196880114CE80D781AC1D0B0B5F486614C807A24A958B98F0509A1C339CCEFEFC85B4E71FE2D392C646F5122AB13C4806F0BB610330055E119CFE6E14B569E6490947BE4156F01D7D306698D426515BCD006FB5F7047CF046D69205852F04FE058E005185CCC2B8A830CCFBF3A49B397A750EA0813D4228E160D9CFFF89B08401B077888DEA435D82BDE9D6B9CDB475C55C61FBCCCC6EF04F206BC982C21701BE80CFB58B2A6316D8657EFC412C5DDCB78C460EEE46BD6104BF97E300A8084B19C098885E128927D6D1CC8916490175E16DF7E640D69285842F101B1EC6073D56025145CC0A7B816D5FCFA2851F8DA4F03E1DCB75025884A50CE09D9103E8D3696368C39733696CA4B86D1660564C44E8F37895B56501E1C201A71D9780A8126685E7CDF74745D1C62FA6D2EE7573E80A023C9122CB8A650C60079DFCF94B5ABD680A4D1C1169C9B95F9778F00690B5656619D7AFB76200DD009F5C1555C2EC70074E1A3D947E45446D4C646F0A96F200E7F6ADA2F751E70A70FDDAF02EAC1F90356666E182019F4DFB16882A6031D808367D39FD1931801DB469D9EC8A56BEC2ACE8D0D0E72CB22680C29957C179F962150677E6A753C6220BF85AA8C8B2620903E02D610B2EFC18E214F80F90B56646E14201DFD059E6839E65853D00AF0B9CF98957F7C4CA2C0BE6360076FF374E6DA4E91346579607B80F3C80AC353349B4F4E816C900F8BE3ED1852DCE84A1E1B47FE302BA66C669C0DC06C0A782CEEC5921057FA2365400BC342C2D0A8D8B8A90B56706E102C15FC06620BAB0C5612FB0F6B329424596154B4C01EBBF985959A35F61516C6438D241333E940A8532D500AF3B8B2E6A71B853674D1C43717B4BDFE1D30F52484E23B5E03D83BBD2AEDE761DC4CA3544CAF92D34FFC3B19535FF2BF0D90C7EC896AC3D330817069CC12D20BA688530717804FDFAFD4293B301DEF64DBB7490EEDF38034E4BDC030F6E9EA1CC3BF1947D37A1188F6F9D8042F56FF888E0F9FFC2FED5F4DEA828C95B89EA5F41DC040E40D69E19840B036D80DE47B954146B164D162AD910E9570E93BA209F0C89A640458F938F41A9A67B82B54B6654B6FB677889BE1990B56706E1C2001FF936FBDEBF29F0C8FA307A181DDF61F8C4AF2EEC05EEDF3C5BAA11680AF22833ED3C9469FAE8E75DBFA9E346560503E093429D81ACBD728A74F4ABF01C3ADFDF2FBA60851203164E1D8F58E02B9353423682D4847D94F3289DD4F92AD268D48560D4E765DD9547BEE9CAE75DBFA5B3DFAB6CD7AF0D3F64D32636CC0C81A05450E10AE00620BA58A5B07CDEFBF4FBFEE5261B8114FC1D5F4BC9E77650EAEF7BE9D1CDA3F4F0FA417A70E54728D434B7CFAB7EA971DFD3B78B3FB2C4D1EFF2302776C860F3AC08A23086EF51FF592EBC4AC01DBEF2E349653302C01B4BC5B300B192F5A1287FED92E9D2AEA5A88E95C87AC069BBACC572081702F8291FFC4837D1C52A0D3682E5F3DEA38B480DCB6204655D0760B77F1B291F8F7C563E4F4BA2FA5522FCE839F33C5D840B012F035E67165DAC52E1FDF6CFA74F908E8F991A1896C50058F9D74F6DA065F33FA86A6E5F1BBE3BDB3C2784B810C01B0CE780E862558279EF47D3D16D8B4DF204A61A00BBFDF843DFD2A7532708EB5085380D78D0CA5A2C8770218077012D7202D85C70FA352576B8748EF0EA61B1C27531C500F87CFFAFDB97D2B4F1A3AA42AA67081EACE6D915E44200DFFEC5274E4417AB32F012ECEC7746D1F12D9FD025238E8FB101E8BBC1A3088CFA74047B677F5842B3278EAAEC655E63B900CC73DB181702D803F013AE4517AB32F0C89CF3DE183ABA693E1D5E379B2EFCBCA4546F60C80078D45F3FF11D1DDD388F0EAD9D83B2A39F85D1CFF01D4366F500BC11C4858A2E566560E5702C10BF6F199DDCFA09ED5B3D8D8E6F9E4FBFEFFBCA64034839B709A3FE73A98CA31BE651D289B5B460CAF867C503F037AD986743880B011C511E07A28B5519D800E6C200F8F430E7F9A7B62FA4BD2B3FA2FDDF4CA7DFB62DA084FDC577128B0C00913D47F7ACF8D4F39B296EF79774E8BB59B4FBEB29746CF3C7947276A37487CF27CF8E0170CA6E9E278D7221801F46B00F882E56656003F878F2044A38F854C9E77EFC8CF6AF9E2E29930D813D42DC2F4B8B6284B40B5B246E60849FDDF55991E2F7AC984A67762E96DEE3E83FEDE2365A30D52277F95A825DC03C0F98E4DB8D00AF2A6D950BAFB2B0016C5AB39A6EC4ED87729FAE09C4EFFD928EAC9F43BB574CA15F964F96BCC2816F67D0E1B5B3A5F99D5FF7AD9A26BDC71C5C331306B242EBBEC19D947EED37FA6AE1273000E93B80AA3A9FC7869BE9D1F3FC40A209C3C2F8C18FCBB52E5025193F2C928E1C3A4869A9B728E9CCAE220360A4EF0BFAA17084F3E85694FDCBB2C2571EF56C14E77EFC9C6E9FD958140B3077AFFD4AE9A9B769C7E64D5579F1479B58FE06B618737C27D1D8F1A39469E03DAD0B5449268F8DA1F8B8384A4B4BA7DB3713E9DAC9CD507EF19B492E1D5C4E1730059CDCBA807E8557600F706AC72218C84A49F11CF92BF10073EFEA5E4ABB7D9DD2D2D3E9D48913F4EEA8E1C26B572178CB5E3A176836E1C2407B50613784188B3C223543FBF7C98B193634F3EAD5AB9AB4B4344A4D4DA35BD72E52E2B1B5258CE0AABC5AC84BC79CE32B4AD756BCA4FCCB3F51FAAD2B282B553280B367CE68C2FBF5510D1BD08F0F5F6AAAA837E01B44BC81AC3D33081706EA01FE560BD1452B1C7E9024E67C7564DFDEB9416DBDB2EABABAE6F9B4F12A88BB70011E800D205522F9F26F50F837C50D40A6D495C0CBBB28FD665C5139E9308083070E50A3FA0D34F5DDDCF2437CBC73A2FAF52E401D345C17DDFA5522E9C01DC8DA33837061801F4260F6C7C19405EEF46103FBAB3A0406DCAFE3E29AEB686BA7E16709366EE841C78E1E9594A5282E35250541E10128BCE44651690670E7FA6FF8FF94A272EEDCB9435B366FA1DACE858F80E36BD675712DF06BD53237125E21A6F0499EC2FA563071B11161AF5AE25430A782BFC817A914A279C4F7EFA7EADEB98B2AD03F20BB762D976CE529A2FC5AC7B536FDF4E34F92B28A0C00A4DCBE4949677F30DA00EE261E86E124172B838DEAE379F3A5C7BFF2F5946B0275D3469E8F7A74E9921335A05F1E7B2551DD2B908D311161E6FD8E8198F0C136EF0C1BC646F089D6852A0CE4DE6ACCBDB95D3B7556050705AB03FC03D51E0D1A6642096A45194C2D07475AB7766D0903E078400A0A7FDB02C53F8D07440670EFEA1E047D493AFF5FC89851A3A5E7FF695F9371B677C86BD3DA2B372438A4A05BE7CEAAC8FE7D556CACA2B65400C3F85BD76104B2F6CC242898E1871396E90B20CA02145F10D6B777F65B1D3BA98203A1F880200A046D5AB5C97276702CF16DE23C22172D5C283000064161523C251E5F576404BA0620057DC99705FF8B5822399906F4EB273400A6AE5B9D6C7FBF8002AE1F1B291B6B78BF0A37047E58A71790B56646E142811DE067D78B2E6E36A2C3061784F6E99DDD058A0FD2523CE3E7EB9FE7EE5A3B5BA4048E0362468FA1DBB76F0B95C8245F3E4589470B83C2E206C041DF05E1FF705079EDDA35EADCA1A35E03C0D450D0A2598B6CD451C3F5E43AB3D176EDD8298F33870A3284ABA00690B56646E14201C7013F02D1C5CB0DBBFAB0BE7D78C4E7EA2A5E46D3D8C3F3093ABC98EB5760E574EDDC4552967626500C0E0A2F160685DA067027E924DE7F1AF469C3655DBC78917CBDDA96F85A186D1093E4FAFAF8E569D7B9C8103A75CA8BB0BC47F80EC1A865BE6388A34A2E184403B336820327740EE6F8E2AE5E97B66DDA66D7727052893A9F61E5F8B6F5A678284BAF018094DBC95250281940FC56047D874A047DDA7000F8DBC9939A669EFABFC656463250D455AD5B77C510BA616AE018813319515F94037E629BB400141369A1EF21E6C2811B4801A24A9804AC553D14E95CF7CE9D73316F16E8533C83F935BFAE9B7B1677B24EA717C1CA69EAE949274F9C289E0A96A03028BC711ACABFF4B3DEA04F211D31C5DE3D7BA9BE7BF1AF84118140340F869A2B6A03C36D0C090A2940D6A0422ACB377198CB10F8B63D17206BCB02C285033E6DFA131055C2583423060FCCEBD9B56B363A231F9D22CD9BA5A069DAB8C9639E67459DAEC0CAA9E7E64E7B76EFD613083E250D245EBB44894997A59F459F51E0B2905D14B83A95FC0A3B019AFA75EA6607C8016169B443D6D0BB5BB7DC914306F2E82DAF21AC05FCD5BCB2B62C205AD3402830E98B201546870ECEEFFF768FECF621ED78AE34A478096F2FEF1C1747675EF0117578315C1C9D68D3868DA51A002BFC4A722AC5EE4FA6917B9229E166E1DF449F65D89B4CFF689AC6D0E85760436DD5A2250784C2F6E8A0E9D0AE7DFEA05E3D73C620F815F59911F0770C4AB783C5449A39FDD315BE08E0483301882A2324263C94E7F91C44D2EC1E4BCC91FA40CE5F801155AAEBD7E58B254BF51A002BFA2A943F16CA6FF85D12350031FB92258328CD08460C1DA6D6970188707371CDF1F3F1CB17B549445060909AD35D293E30DD1BF0713D7E74AFAC250B0ADF6E14131EC6CFA333FA5EC1914306E5F582BB0FC6DC57DA3C2F40D3BC69F3471851F9A24E16C181E0BBEFBC432988F675952829FF562A8D93955F5F3600FE79C281644AC47B2223B879F326F5EDD54B638A01007513CF2659DC069D36E945890F302DE48C1A32C894C7F04E78CBA1BE740F6785082EC83404A9720584F0A8E7B4AE63BB0E2A34D0E88E50F0F1F6CD7575AE6594EB576025F5EAD183AE5FBF5E4C898AF2C743D10DD73E553EC33F7BE06F930E213BD03102CE26121313D51DDBB537C90330988E5498BEF40684A5A0E9D4BE03A78DECDA0D7983DBC0BC9B3F86842F065E047A1F19C7733D2C19A33ED8603024825D7FC37AF579B9D768D7CFB00708F0F5A384848462A9E02D44FE1F1CBE556CE46BA318C1FCE3B729059FD53680B8B8384DDBD66DD4A5AD01E841D3A06EFD4C5EBA16B5D110EC0DFA76EF9E6D2036988F91FF42858D7E457061869F4FCBDB8FC52A357CD00055D78E9DD8F24D1EF50A2D9BB77CE264EF60B4EB5770A8614B2D9A34D59C397D5AA3A482FC9A959D4D9F9DCF9094ACAB7C85466BAFD3BACB8F283333B3C878E4358082268D3CD5C60681DA7040D8BA65AB1C511B8D44DD0D6932B226D19490061A00592B15287C51C05EA0D87383A306F4CB85BB64972F6A8C51F0E8F7A8DF20D350DA278295D4A04E5DCD81FDFB250360B2A17C9607B9053478772AD55B5352F9FCB71107D2E8914ACD8F8AA0274F9E4846C0FFBF67CF9E82BAB5DDCA62001A671871630FCF87685799BC80024F09430BD70DB40D606E4C44D80B081A65AD54B0A0020C5B203F97461AF948695426067A42FCFD02D46D5AB5512103C84127B221183D15F09EFDF66DDBD577EFDD2B52BE2227D273C87BF34DAAAF6504FCB3DF969B74FE5EAEFC29988046438F1F3F96B2890DEBD767633E37652AD2D47270CCC714F6C4ABB557AEB249541EB84FD908B43C4112A80D646D5482F0C511E8714630233A6C483EBB2A7328BF88C060F6066AAF365E790DEB35C8E24EE5CED5E9EC12C0736856AF5C55A052A964753E95020DD182B30F348805348A01F0B4B022FEA1468DF7B4858D803DC1B4A953B330FF0BF71F74D0C050F21B35F4C86AEBE5AD2A9CFB83C56D2B233DBABCC5FB09EC09A2A387463CC7873F2B55D808260C8D787350AF9E8782A13051A5CB4FA12120A2CEE3CEE54EE6CED6E9FC2238589B397D7A2674C8FEBC849CBD9B9BDB7CC3F57C0EFC18FC5C70EE5E6E9EFC76315143460E1B9E63FB6675E1B564D42E4ECEAAC68D3CB3BCDBFA70EE5F2E775F1ADCC7A17D7B1F9C383CF2BF953AFA1519133AD8C6B18E870D22D60EA860866E852D80C6079D8CA02CC7D5C9399F47BBAE42385D0B1D34F8495E5E9ED0007EB89179AFD1DAA402C50378AEBBAE3E9C92FDD4FF6B0997D1AF779F1C510A886BAB31DDE4366DDC340B29ABD12B9BE524A37D48BB2097FA9E36A34307C95AA86441A59817C16772252B028D8FB74F5E833AF54AA48AACAC2E1D3AE6C37D8B0C4033FFCC830775D724A915038017506F497C9223BF5F4C50461E82DA5C8101A811A83EF1F5F12BD31A4719E1EBCC0C0808E4BE967BBF8A08570854074781A8F266C5CFC72FB751038FC7725C504C393C05F87879E521802B90F5582498E70B620FA767D65D73AD2808E40C60F6A9FB19FC76E1A79E0ACAC8F36EDD2657B406C0D7F66CD828D3CFD7DFE825DF727208BC09E45EAF4282E0CF26A8D008DA8214206A803950B76ED9FA899B8B2BEF0F0803334ED79A376EA2BE9E9454C200720B3405480573E1018A0C807F0EDF9B9A85F74A18405252526ED3469E79A5A4806A77D7DAB9C85838D7B7A427B80D5A01A9AFABA470E50203839EC76B14E075705143CA4CE1A86FF8980F610A1451042BABBE7B9DFCF3E7CE9708EC3272D5795D76DECAD15E0BE09FDFDA794B85F74A3C45F2FCB9733975DDDC4A330089426FE0F1C442DE80FB7270A07FD07378957BBB8A0A57109EE06F785D08CA9DFFCA181CF5BA2038D3FC7AE870090F70EB49BECAEFFB9B79BAEB00FEDFDFCCC77B250C60F72FBF3C44D661EC829425BC01F7E10CC07D2AF7721517AE28A806360251A38C06A35E65CCA8D78523F4ED5BB79588ECE3EEE766B7D870234F7B3F807F6EB9E146FEC5FBB9BA0B079AC50B17A563FE376945D28CDE808D68357819C8BDFB0C88B7AFBF620435C16E206A9C41F8544D3DF73A25CEFF1B83438D9A9AAF972F2F31A27FB89E79CF432B0554E054F050C95450F3CEF80959B66F563765155041CD9B59BCAC2D6A9B91FC0838B0B609F26F27F7EE332281018120988DA016E0E855D44043F021CB321900A76D50DE235EC89195C9C2296086760AA8204A050B2061838764DABD69DA367021F6EAE64D9B171D132F03FB8123E0B84AEED5674C385A951A1010E4060E0351434BC5D7C737CFD5B99649EE9F6103E8DBABB72A3737B768819753C0189D145041940AE6E4E414BCDDADBB4AB4086408B75A2E39E5980258F92E411840C8F9E5DE7C4645CB085CC05E206A706994C90B70DE1E121894F730E3615120284A0115F86F617B53B3B553C18C8C0C55A0AF5FB6680DC0003CFA4D3A0DA4C52FC0A9D07B3EE3CA57040D4266204D077660333069ADDCD71B5EC0C9D9242FC04AF36AD9AA203525F5A942910276D649011544A960CAED94FC56CD5BE4996A00B579F4EBDC206204DC27EB400DF0C751BE22817E2152A3D0B857002F199B72544AE3E9D1C8242FC0797BE3861E05572E5F2E5268B220055410A58297122EE578D4ABAF32B406A003467F3353473FA78DF34135048D36ED8242E45EFB030A1AC9BC044681BB40D42125E0CD1653BC002BAD8E6BED8253A74E15291429604E8B0DD78BA580450600901E164B054F9E3891E3EEE26AD2A9241EFDBAB78719E00E1806FE17C8BDF40797424F10F8021AEC0F4E0363468B86D7DDD1C9467B013EC4B177CF9EA2D5407D29A082940ADE2E4A0535EBD7AEBB63E2A92475B326468F7EFECC29E007B82FE4DEF9930847B7FE81D27A810358060C2E1DB31770312D16506FDAB04119D14801EF0B5340054E05373F4D053533A64DCB400660B4C1F1D6B091A33F13F03468D7213044DA43F9D30A3A8161F7F736B8004A0B10357C20049D6DD4C20C076F0B172C6085F2691FBD29A0020782B3E45450A3D1A8470D1FC18B40C2B20560F4373534FAF93D6E630FF07720F7C29F5C780404054A1B1D9C25CC057A63039FB63E467B01CEDF87450D7D545090AF2E2D05545052411552413E08D2BF4FDF6C63D700F8FE0503A39FE77A5ED3B70BF4435BFDADCA2F21F29A011F76680A38257A0C743B52D3A881715E8095D7FDADAEF9D959599A0C95FE145081DFEBB2F356EE43953A3F2B3333BF53FB0EA2832022D47C2A88EBA6535786DBB006709BFE02E4D65A452881BC8F10282D8270A6E00378DDE01128EA54C90B381AF6023C05F8FBF8E43DB87FAFE0566681DE14504149056F6715E4DFBF7B37CFBB8D578E316B00AE4E18FD8547C2B415CF47C1B9EEDC8697783917235F6EA5550C0A775680640841FF07F82004078A7CD0846304788186FC989852BD002BAF65B3E6EA945BC9EAF88C3CBD29A082920AE2B3AAE41BD7554D3D1B1B3C070030FA8BEE01E4BA711DBF005CE797FCA1F860EBA82FBB0476ED6E13E81F6813E01FF4577428EF298C04C7BDDB7ADF439A57AA1760E535AC5B2F3F213E5EF553724EA929A002A78247D27255F1172EE4D47373376800AE4ECEB9C84EEEA34E2700AF6DB821A67931888DD7DB576E8555CC22C1E8D4E0A0E0E7D0B9D502FC029BD776769902259C060F80305D737371D59C38762C7FC1F947A5A6800A9C0A6EBD9E9D7370EFDE4750AEBE3500FEFB7D70A26E6DF709507A0B502DD03F00C1DD1F6C09B7AA8A93AD1DB07D1E4AF80FF00403C16A7011DC01D213446BD93B6876ECD89933FEE8FDACD25240050E04E79CC9C858BC68512A463F2B9AA7991C900E2E8015A01FF0002F3BD9DA731DE45A59A552A496839D4DF5576BDA38DADABF0865BC06EA802010E658D3F6E3B51B36ED0ADF7FE7183CC02528F9264801E9E0AE0CFFCC7FBB81CF2444EC4B3B3CE983C9DFD77CE3CD392863080800EEE015473BBBBF38BC5AC3C6D1DEAAF42A2DFFB07DC9C6E9753B9B37AABDFCFCB69FF6FCBDDB0F29FF867B7F1D4AB6032EC01DD493E19FF96F76F000AF2315FCF747B33FFEFB5F6D6C9E7778C3D6C6F1B155D956B18A55AC6215AB58C52A56F9C3888DCDFF07FF1CDA5CF22675400000000049454E44AE426082)
GO

INSERT INTO Speciality(content) VALUES (N'Manager')
INSERT INTO Speciality(content) VALUES (N'Staff')
GO

INSERT INTO Staff(fname, lname, identityNumber, gender, bdate, address, phone, idPhoto, salary, bonus, idSpeciality, pass) VALUES (N'An', N'Tran', N'215523795', N'Male', '20000925', N'Binh Dinh', N'0392889894', 1, 10000000, 500000, 1, N'1')
INSERT INTO Staff(fname, lname, identityNumber, gender, bdate, address, phone, idPhoto, salary, bonus, idSpeciality, pass) VALUES (N'Bao', N'Le Nguyen Gia', N'43543264343', N'Male', '20000703', N'Dong Nai', N'0385784391', 2, 15000000, 700000, 2, N'1')
GO

--======================================================================================--
CREATE FUNCTION [dbo].[non_unicode_convert](@inputVar NVARCHAR(MAX) )
RETURNS NVARCHAR(MAX)
AS
BEGIN    
    IF (@inputVar IS NULL OR @inputVar = '')  RETURN ''
   
    DECLARE @RT NVARCHAR(MAX)
    DECLARE @SIGN_CHARS NCHAR(256)
    DECLARE @UNSIGN_CHARS NCHAR (256)
 
    SET @SIGN_CHARS = N'ăâđêôơưàảãạáằẳẵặắầẩẫậấèẻẽẹéềểễệếìỉĩịíòỏõọóồổỗộốờởỡợớùủũụúừửữựứỳỷỹỵýĂÂĐÊÔƠƯÀẢÃẠÁẰẲẴẶẮẦẨẪẬẤÈẺẼẸÉỀỂỄỆẾÌỈĨỊÍÒỎÕỌÓỒỔỖỘỐỜỞỠỢỚÙỦŨỤÚỪỬỮỰỨỲỶỸỴÝ' + NCHAR(272) + NCHAR(208)
    SET @UNSIGN_CHARS = N'aadeoouaaaaaaaaaaaaaaaeeeeeeeeeeiiiiiooooooooooooooouuuuuuuuuuyyyyyAADEOOUAAAAAAAAAAAAAAAEEEEEEEEEEIIIIIOOOOOOOOOOOOOOOUUUUUUUUUUYYYYYDD'
 
    DECLARE @COUNTER int
    DECLARE @COUNTER1 int
   
    SET @COUNTER = 1
    WHILE (@COUNTER <= LEN(@inputVar))
    BEGIN  
        SET @COUNTER1 = 1
        WHILE (@COUNTER1 <= LEN(@SIGN_CHARS) + 1)
        BEGIN
            IF UNICODE(SUBSTRING(@SIGN_CHARS, @COUNTER1,1)) = UNICODE(SUBSTRING(@inputVar,@COUNTER ,1))
            BEGIN          
                IF @COUNTER = 1
                    SET @inputVar = SUBSTRING(@UNSIGN_CHARS, @COUNTER1,1) + SUBSTRING(@inputVar, @COUNTER+1,LEN(@inputVar)-1)      
                ELSE
                    SET @inputVar = SUBSTRING(@inputVar, 1, @COUNTER-1) +SUBSTRING(@UNSIGN_CHARS, @COUNTER1,1) + SUBSTRING(@inputVar, @COUNTER+1,LEN(@inputVar)- @COUNTER)
                BREAK
            END
            SET @COUNTER1 = @COUNTER1 +1
        END
        SET @COUNTER = @COUNTER +1
    END
    -- SET @inputVar = replace(@inputVar,' ','-')
    RETURN @inputVar
END
GO
-------------------------
--- Created
CREATE PROC USP_InsertCar_ImageCar_Contract_ToCustomer
@idCustomer INT, @typeCar NVARCHAR, @idStaff INT, @typeParking NVARCHAR(30), @valueParking INT , @imageFrontIn IMAGE, @imageBackIn IMAGE
AS
BEGIN	
		INSERT INTO Car(type) VALUES (@typeCar)
		DECLARE @idCar INT
		SELECT @idCar = MAX(id) FROM car
		INSERT INTO ImageCar(idCar, frontCheckIn, backCheckIn, status) VALUES (@idCar, @imageFrontIn, @imageBackIn, 0)
		INSERT INTO Contract(timeIn, price, idCustomer, idStaff, idCar, typeParking, valueParking) VALUES (GETDATE(), 0, @idCustomer, @idStaff, @idCar, @typeParking, @valueParking)
END
GO
----------------------------------------------------
----------Created
CREATE PROC USP_CheckInParking
@qrCode NVARCHAR(30), @idStaff INT, @typeCar NVARCHAR(30), @price FLOAT, @typeParking NVARCHAR(30), @valueParking INT ,@imageFrontIn IMAGE, @imageBackIn IMAGE
AS
BEGIN
	DECLARE @idCustomer INT
	DECLARE @isUnregisteredCustomers INT = 0
	DECLARE @countID INT = 0 -- Nếu 1 id và TypeCustomer != 0 thì là thành viên đăng kí - ngược lại là chưa
	SELECT @countID = COUNT(*) FROM Customer WHERE qrCode = @qrCode AND typeCustomer <> 0
	IF (@countID = 1) -- là thành viên đã đăng ký
	BEGIN
		SELECT @idCustomer = id FROM Customer WHERE qrCode = @qrCode
		EXEC USP_InsertCar_ImageCar_Contract_ToCustomer @idCustomer, @typeCar , @idStaff , @typeParking, @valueParking, @imageFrontIn , @imageBackIn
	END
	ELSE
	BEGIN 
		INSERT INTO Customer(TypeCustomer, totalMoney, qrCode) VALUES (0, @price, @qrCode)
		SELECT @idCustomer = MAX(id) FROM Customer
		EXEC USP_InsertCar_ImageCar_Contract_ToCustomer @idCustomer , @typeCar , @idStaff , @typeParking, @valueParking, @imageFrontIn , @imageBackIn
	END	
END
GO
------------------------------
-----Create
CREATE PROC USP_CheckOutParking
@qrCode NVARCHAR(30), @idStaff INT, @price FLOAT, @imageFrontOut IMAGE, @imageBackOut IMAGE
AS
BEGIN
	DECLARE @idContract INT
	SELECT @idContract = Con.id FROM Customer as Cus , Contract as Con WHERE Cus.id = Con.idCustomer AND timeOut IS NULL AND qrCode = @qrCode
	UPDATE Contract SET timeOut = GETDATE() , price = @price , idStaff = @idStaff WHERE id = @idContract
	DECLARE @idCustomer INT = 0
	SELECT @idCustomer = idCustomer FROM Contract WHERE id = @idContract
	UPDATE Customer SET totalMoney = totalMoney + @price;
	DECLARE @idImage INT
	SELECT @idImage = IC.id FROM Contract as Con, Car as C, ImageCar as IC WHERE @idContract = Con.id AND Con.idCar = C.id AND IC.idCar = C.id
	UPDATE ImageCar SET frontCheckOut = @imageFrontOut , backCheckOut = @imageBackOut, status = 1 WHERE id = @idImage -- Cập nhật status trong ImageCar
END
GO
-----------------------------------

---------------------------------------
 --------Created   ------------------- Check In by qr code
 CREATE PROC USP_CheckInByQRCode
 @qrCode NVARCHAR(30)
 AS
 BEGIN
	SELECT COUNT(*) FROM Customer as Cus , Contract as Con WHERE Cus.id = Con.idCustomer AND timeOut IS NULL AND qrCode = @qrCode -- 0 - checkin còn lại là checkout
 END
 GO
 ---------------------------------------------
 ------Create
 CREATE PROC USP_GetIDCarParking
 @qrCode NVARCHAR(30)
 AS
 BEGIN
	SELECT Con.idCar FROM Customer as Cus , Contract as Con WHERE Cus.id = Con.idCustomer AND timeOut IS NULL AND qrCode = @qrCode
 END
 GO
 -----------------------------------
 -----------------
 CREATE PROC USP_GetContractByQRCode
 @qrCode NVARCHAR(30)
 AS
 BEGIN
	SELECT con.id, con.timeIn, con.timeOut, con.price, con.idCustomer, con.idStaff, con.idCar, con.typeParking, con.valueParking FROM Customer as Cus , Contract as Con WHERE Cus.id = Con.idCustomer AND timeOut IS NULL AND qrCode = @qrCode -- 0 - checkin còn lại là checkout
 END
 GO
 ------------------------------
 ----------------------------------
 CREATE PROC USP_UpdatePriceContractAndMoneyCustomer
 @idContract INT, @price FLOAT
 AS
 BEGIN
	UPDATE Contract SET price = @price WHERE id = @idContract
	DECLARE @idCustomer INT = 0
	SELECT @idCustomer = idCustomer FROM Contract WHERE id = @idContract
	UPDATE Customer SET totalMoney = totalMoney + @price WHERE id = @idCustomer
 END
 GO
 ------------------------------------
 ----------------
CREATE PROC USP_LoginAccountManager
@userName INT, @passWord NVARCHAR(30)
AS
BEGIN
	SELECT * FROM Staff as st, Speciality as Sp WHERE st.idSpeciality = Sp.id AND st.id = @userName AND pass = @passWord AND content = N'Manager'
END
GO
 ------------------------
 ---------------------------
 CREATE PROC USP_LoginAccountStaff
 @userName INT, @passWord NVARCHAR(30)
AS
BEGIN
	SELECT * FROM Staff as st, Speciality as Sp WHERE st.idSpeciality = Sp.id AND st.id = @userName AND pass = @passWord AND content <> N'Manager'
END
GO
 -----------------------------
 -----------------------------
 CREATE PROC USP_InsertCustomer
 @fname NVARCHAR(30), @lname NVARCHAR(30), @identityNumber NVARCHAR(30), @gender NVARCHAR(30), @bdate DATE, @address NVARCHAR(100), @phone NVARCHAR(30), @photo Image, @typeCustomer INT, @qrCode NVARCHAR(30)
 AS
 BEGIN
	INSERT INTO Photo(image) VALUES (@photo)
	DECLARE @maxIDPhoto INT = 0
	SELECT @maxIDPhoto = MAX(id) FROM Photo;
	INSERT INTO Customer(fname, lname, identityNumber, gender, bdate, address, phone, idPhoto, typeCustomer, totalMoney, qrCode) VALUES(@fname, @lname, @identityNumber, @gender, @bdate, @address, @phone, @maxIDPhoto, @typeCustomer, 0, @qrCode)
 END
 GO
 ----------------------------------
 ---------------------------------
CREATE PROC USP_IsExistByQRCodeOfCustomer -- Kiểm tra xem mã qrcode có tồn tại chưa
@qrCode NVARCHAR(30)
AS
BEGIN
	SELECT * FROM dbo.Customer WHERE qrCode = @qrCode
END
GO
 ----------------------------------
 ---------------------------------
 CREATE PROC USP_UpdateCustomer
 @id INT, @fname NVARCHAR(30), @lname NVARCHAR(30), @identityNumber NVARCHAR(30), @gender NVARCHAR(30), @bdate DATE, @address NVARCHAR(100), @phone NVARCHAR(30), @photo Image, @typeCustomer INT, @qrCode NVARCHAR(30)
 AS
 BEGIN
	UPDATE Customer SET fname = @fname, lname = @lname, identityNumber = @identityNumber, gender = @gender, bdate = @bdate, address = @address, phone = @phone, typeCustomer = @typeCustomer, qrCode = @qrCode WHERE id = @id
	DECLARE @idPhoto INT = 0
	SELECT @idPhoto = idPhoto FROM Customer WHERE id = @id
	UPDATE Photo SET image = @photo WHERE id = @idPhoto
 END
 GO
 -----------------------------------------
 ------------------------------------
 CREATE PROC USP_DeleteCustomer
 @id INT
 AS
 BEGIN
	DECLARE @idPhoto INT = 0
	SELECT @idPhoto = idPhoto FROM Customer WHERE id = @id	
	DELETE FROM Receipt WHERE idContract IN (SELECT id FROM Contract WHERE idCustomer = @id)
	DELETE FROM ContractDetail WHERE idContract IN (SELECT id FROM Contract WHERE idCustomer = @id)
	DELETE FROM Contract WHERE idCustomer = @id
	DELETE FROM Photo WHERE id = @idPhoto
	DELETE FROM Customer WHERE id = @id

 END
 GO
 ----------------------------------
 ---------------------------------
 CREATE PROC USP_InsertStaff
 @fname NVARCHAR(30), @lname NVARCHAR(30), @identityNumber NVARCHAR(30), @gender NVARCHAR(30), @bdate DATE, @address NVARCHAR(100), @phone NVARCHAR(30), @photo Image, @idSpeciality INT, @passWord NVARCHAR(30), @salary FLOAT, @bonus FLOAT
 AS
 BEGIN
	INSERT INTO Photo(image) VALUES (@photo)
	DECLARE @maxIDPhoto INT = 0
	SELECT @maxIDPhoto = MAX(id) FROM Photo;
	INSERT INTO Staff(fname, lname, identityNumber, gender, bdate, address, phone, idPhoto, idSpeciality , salary, bonus , pass) VALUES(@fname, @lname, @identityNumber, @gender, @bdate, @address, @phone, @maxIDPhoto, @idSpeciality, @salary, @bonus, @passWord)
 END
 GO
 -----------------------------------
 -------------------------------
 CREATE PROC USP_UpdateStaff
 @id INT, @fname NVARCHAR(30), @lname NVARCHAR(30), @identityNumber NVARCHAR(30), @gender NVARCHAR(30), @bdate DATE, @address NVARCHAR(100), @phone NVARCHAR(30), @photo Image, @idSpeciality INT, @passWord NVARCHAR(30), @salary FLOAT, @bunos FLOAT
 AS
 BEGIN
	UPDATE Staff SET fname = @fname, lname = @lname, identityNumber = @identityNumber, gender = @gender, bdate = @bdate, address = @address, phone = @phone, idSpeciality = @idSpeciality, pass = @passWord, salary = @salary, bonus = @bunos WHERE id = @id
	DECLARE @idPhoto INT = 0
	SELECT @idPhoto = idPhoto FROM Staff WHERE id = @id
	UPDATE Photo SET image = @photo WHERE id = @idPhoto
 END
 GO
 ------------------------------------------
 --------------------------------------------
 CREATE PROC USP_DeleteStaff
 @id INT
 AS
 BEGIN
	DECLARE @idPhoto INT = 0
	SELECT @idPhoto = idPhoto FROM Staff WHERE id = @id	
	DELETE FROM Receipt WHERE idContract IN (SELECT id FROM Contract WHERE idStaff = @id)
	DELETE FROM ContractDetail WHERE idContract IN (SELECT id FROM Contract WHERE idStaff = @id)
	DELETE FROM Contract WHERE idStaff = @id
	DELETE FROM Photo WHERE id = @idPhoto
	DELETE FROM Staff WHERE id = @id

 END
 GO
 --------------------------------------------------
 ------------------------------------------------
 CREATE PROC USP_GetListStaff
 AS
 BEGIN
	SELECT st.id as [ID Staff], fname as [First Name], lname as [Last Name], identityNumber as [ID Number], gender as [Gender], bdate as [Birth Date], 
	address as [Address], phone as [Phone], image as [Image], salary as [Salary], bonus as [Bouns], sp.content as [Specialiy]
	FROM Staff AS st, Photo as pt, Speciality as sp
	WHERE st.idPhoto = pt.id AND st.idSpeciality = sp.id
 END
 GO
 -----------------------------------------------
 --------------------------------------
 CREATE PROC USP_SearchListStaff
 @keyWord NVARCHAR (30)
 AS
 BEGIN
	SELECT st.id as [ID Staff], fname as [First Name], lname as [Last Name], identityNumber as [ID Number], gender as [Gender], bdate as [Birth Date], 
	address as [Address], phone as [Phone], image as [Image], salary as [Salary], bonus as [Bouns], sp.content as [Specialiy]
	FROM Staff AS st, Photo as pt, Speciality as sp
	WHERE st.idPhoto = pt.id AND st.idSpeciality = sp.id AND CONCAT(st.id, fname, identityNumber, phone, gender, address, sp.content) LIKE N'%' + @keyWord + '%'
 END
 GO
 -----------------------------------------------
 --------------------------------------
 CREATE PROC USP_GetListCustomer
 AS
 BEGIN
	SELECT ct.id as [ID Customer], fname as [First Name], lname as [Last Name], identityNumber as [ID Number], gender as [Gender], bdate as [Birth Date], 
	address as [Address], phone as [Phone], image as [Image], tc.name as [Type], qrCode as [QR CODE]
	FROM Customer AS ct, Photo as pt, TypeCustomer as tc
	WHERE ct.idPhoto = pt.id AND ct.typeCustomer = tc.id AND typeCustomer <> 0
 END
 GO
 -----------------------------------------------
 --------------------------------------
 CREATE PROC USP_SearchListCustomer
 @keyWord NVARCHAR(30)
 AS
 BEGIN
	SELECT ct.id as [ID Customer], fname as [First Name], lname as [Last Name], identityNumber as [ID Number], gender as [Gender], bdate as [Birth Date], 
	address as [Address], phone as [Phone], image as [Image], tc.name as [Type], qrCode as [QR CODE]
	FROM Customer AS ct, Photo as pt, TypeCustomer as tc
	WHERE ct.idPhoto = pt.id AND ct.typeCustomer = tc.id AND typeCustomer <> 0 AND CONCAT(ct.id, fname, identityNumber, phone, gender, tc.name) LIKE N'%' + @keyWord + '%'
 END
 GO
 -----------------------------------------------
 --------------------------------------
 CREATE PROC USP_GetListContract
 AS
 BEGIN
	SELECT cus.id as [ID Customer], cus.fname as [First Name Customer], cus.lname as [Last Name Customer], tpc.name as[Type Customer], car.type as [Type Car],car.id as [ID Car],
	timeIn as [Time In], timeOut as[Time Out], valueParking as [Value Parking], typeParking as [Type Parking], price as [Price], sta.id as [ID Staff]
	FROM Contract as con, Customer as cus, Staff as sta, Car as car, TypeCustomer tpc
	WHERE con.idCustomer = cus.id AND con.idStaff = sta.id AND con.idCar = car.id AND cus.typeCustomer = tpc.id
 END 
 GO
 ------------------------------
 ---------------------------------------------
 CREATE PROC USP_SearchListContract
 @keyWord NVARCHAR(30)
 AS
 BEGIN
	SELECT cus.id as [ID Customer], cus.fname as [First Name Customer], cus.lname as [Last Name Customer], tpc.name as[Type Customer], car.type as [Type Car],car.id as [ID Car],
	timeIn as [Time In], timeOut as[Time Out], valueParking as [Value Parking], typeParking as [Type Parking], price as [Price], sta.id as [ID Staff]
	FROM Contract as con, Customer as cus, Staff as sta, Car as car, TypeCustomer tpc
	WHERE con.idCustomer = cus.id AND con.idStaff = sta.id AND con.idCar = car.id AND cus.typeCustomer = tpc.id AND CONCAT(cus.id, car.id, sta.id, cus.fname) LIKE N'%' + @keyWord + '%'
 END
 GO
 -----------------------------------------------
 --------------------------------------
 CREATE PROC USP_SearchListContractByTimeIn
 @timeInStart DATETIME, @timeInEnd DATETIME
 AS
 BEGIN
	SELECT cus.id as [ID Customer], cus.fname as [First Name Customer], cus.lname as [Last Name Customer], tpc.name as[Type Customer], car.type as [Type Car],car.id as [ID Car],
	timeIn as [Time In], timeOut as[Time Out], valueParking as [Value Parking], typeParking as [Type Parking], price as [Price], sta.id as [ID Staff]
	FROM Contract as con, Customer as cus, Staff as sta, Car as car, TypeCustomer tpc
	WHERE con.idCustomer = cus.id AND con.idStaff = sta.id AND con.idCar = car.id AND cus.typeCustomer = tpc.id AND timeIn BETWEEN @timeInStart AND @timeInEnd
 END 
 GO
 ------------------------------
 ---------------------------------------------
 CREATE PROC USP_SearchListContractByTimeOut
 @timeOutStart DATETIME, @timeOutEnd DATETIME
 AS
 BEGIN
	SELECT cus.id as [ID Customer], cus.fname as [First Name Customer], cus.lname as [Last Name Customer], tpc.name as[Type Customer], car.type as [Type Car],car.id as [ID Car],
	timeIn as [Time In], timeOut as[Time Out], valueParking as [Value Parking], typeParking as [Type Parking], price as [Price], sta.id as [ID Staff]
	FROM Contract as con, Customer as cus, Staff as sta, Car as car, TypeCustomer tpc
	WHERE con.idCustomer = cus.id AND con.idStaff = sta.id AND con.idCar = car.id AND cus.typeCustomer = tpc.id AND timeOut BETWEEN @timeOutStart AND @timeOutEnd
 END 
 GO
 ------------------------------
 ---------------------------------------------
 CREATE PROC USP_TotalRevenueByDay
 @dateIn DATE, @dateOut DATE
 AS
 BEGIN
	SELECT Convert(DATE, timeOut) as [Date], SUM(price) as [Total Revenue] FROM Contract WHERE timeOut BETWEEN Convert(NVARCHAR, @dateIn) + ' 00:00:00' AND Convert(NVARCHAR, @dateOut) + ' 23:59:59'
	GROUP BY Convert(DATE, timeOut)
 END
 GO
 ------------------------------------------- RENT CAR
 -------------------------------------------------
 CREATE PROC USP_InsertCarRentOfCustomer
 @idOwner INT, @licensePlates NVARCHAR(30), @type NVARCHAR(30), @color NVARCHAR(30), @frontCar IMAGE, @backCar IMAGE
 AS
 BEGIN
 	INSERT INTO dbo.Car (licensePlates, type, color ) VALUES (@licensePlates, @type, @color)
	DECLARE @idCar INT
	SELECT @idCar = MAX(id) FROM dbo.Car
	INSERT INTO dbo.ImageCarRent ( idCar, frontCheckIn, backCheckIn ) VALUES  ( @idCar, @frontCar, @backCar)
	INSERT INTO dbo.StatusCar(idCar, idOwner, idRenter, isOwner) VALUES (@idCar, @idOwner, 0, 0)
	      
 END
 GO
 -------------------------------------------
 -------------------------------------------------
 CREATE PROC USP_InsertCarRentOfCompany
 @licensePlates NVARCHAR(30), @type NVARCHAR(30), @color NVARCHAR(30), @frontCar IMAGE, @backCar IMAGE
 AS
 BEGIN
 	INSERT INTO dbo.Car (licensePlates, type, color ) VALUES (@licensePlates, @type, @color)
	DECLARE @idCar INT
	SELECT @idCar = MAX(id) FROM dbo.Car
	INSERT INTO dbo.ImageCarRent ( idCar, frontCheckIn, backCheckIn ) VALUES  ( @idCar, @frontCar, @backCar)
	INSERT INTO dbo.StatusCar ( idCar, idOwner, idRenter, isOwner )VALUES  ( @idCar, 0, 0, 1) -- of company and at company and expired (đã về với chủ)
 END
 GO
 ------------------------------------------------- 
------------------------------------------------------
CREATE PROC USP_IsExistCarRentByLicensePlates -- Kiểm tra xem bảng số xe hiện có đang được quản lý bởi workshop
@licensePlates NVARCHAR(30)
AS
BEGIN
	DECLARE @idCar INT
	SELECT @idCar = id FROM dbo.Car WHERE licensePlates = @licensePlates
	SELECT * FROM dbo.StatusCar
	WHERE idCar = @idCar AND (idOwner = 0 OR (idOwner <> 0 AND isOwner = 0))
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_GetAllDataCarRentAtCompany -- Danh sách xe trong bãi xe
AS
BEGIN
	SELECT car.id AS [ID], car.licensePlates AS [License Plates], car.type AS [Type], car.color AS [Color], img.frontCheckIn AS [Front Image], img.backCheckIn AS [Back Image] 
	FROM dbo.Car AS car, dbo.ImageCarRent AS img, dbo.StatusCar AS stt
	WHERE car.id = img.idCar AND car.id = stt.idCar AND stt.idRenter = 0 -- at company
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_GetAllDataCarRentCustomerCanRent -- Danh sách xe mà khách hàng có thể thuê - các xe trừ xe khách hàng cho thuê.
@idCustomer INT
AS
BEGIN
	SELECT car.id AS [ID], car.licensePlates AS [License Plates], car.type AS [Type], car.color AS [Color], img.frontCheckIn AS [Front Image], img.backCheckIn AS [Back Image] 
	FROM dbo.Car AS car, dbo.ImageCarRent AS img, dbo.StatusCar AS stt
	WHERE car.id = img.idCar AND car.id = stt.idCar AND stt.idOwner <> @idCustomer AND stt.idRenter = 0 -- at company
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_SearchCarRentAtCompanyByTypeCar
@typeCar NVARCHAR(30)
AS
BEGIN
	SELECT car.id AS [ID], car.licensePlates AS [License Plates], car.type AS [Type], car.color AS [Color], img.frontCheckIn AS [Front Image], img.backCheckIn AS [Back Image] 
	FROM dbo.Car AS car, dbo.ImageCarRent AS img , dbo.StatusCar AS stt
	WHERE car.id = img.idCar AND car.type = @typeCar AND car.id = stt.idCar AND stt.idRenter = 0 -- at company
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_SearchCarRentAtCompanyByColor
@color NVARCHAR(30)
AS
BEGIN
	SELECT car.id AS [ID], car.licensePlates AS [License Plates], car.type AS [Type], car.color AS [Color], img.frontCheckIn AS [Front Image], img.backCheckIn AS [Back Image] 
	FROM dbo.Car AS car, dbo.ImageCarRent AS img, dbo.StatusCar AS stt
	WHERE car.id = img.idCar AND car.color = @color AND car.id = stt.idCar AND stt.idRenter = 0 -- at company
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_SearchCarRentAtCompanyByTypeCarAndColor
@typeCar NVARCHAR(30), @color NVARCHAR(30)
AS
BEGIN
	SELECT car.id AS [ID], car.licensePlates AS [License Plates], car.type AS [Type], car.color AS [Color], img.frontCheckIn AS [Front Image], img.backCheckIn AS [Back Image] 
	FROM dbo.Car AS car, dbo.ImageCarRent AS img, dbo.StatusCar AS stt
	WHERE car.id = img.idCar AND car.type = @typeCar AND car.id = stt.idCar AND car.color = @color AND stt.idRenter = 0 -- at company
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_DeleteCarRentByIDCar
@idCar INT
AS
BEGIN
	DELETE FROM dbo.ImageCarRent WHERE idCar = @idCar
	DELETE FROM dbo.StatusCar WHERE idCar = @idCar
	DELETE FROM dbo.Car WHERE id = @idCar
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_CustomerRentCarByIDCar
@idRenter INT, @idCar INT
AS
BEGIN
	UPDATE dbo.StatusCar SET idRenter = @idRenter , isOwner = 0 WHERE idCar = @idCar -- cập nhật người xe lại có id người thuê xe = biến truyền vào
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_CheckCustomerWithCarRental
@idCustomer INT
AS
BEGIN
	SELECT * 
	FROM dbo.StatusCar 
	WHERE ((idOwner = @idCustomer AND idRenter <> @idCustomer AND isOwner = 0 ) OR (idOwner <> @idCustomer AND idRenter = @idCustomer AND isOwner = 0))
	-- khách hàng cho thuê xe (xe chưa được trả lại)        -- Khách hàng thuê xe (Xe không phải của khách hàng đến thuê và xe này đang được khách hàng này thuê)
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_GetCarRentByIDCustomer -- Lấy danh sách xe mà khách hàng này thuê hoặc mượn
@idCustomer INT
AS
BEGIN
	SELECT car.id, car.licensePlates AS [licensePlates], car.type, car.color, img.frontCheckIn, img.backCheckIn, stt.idOwner, stt.idRenter, stt.isOwner
	FROM dbo.StatusCar AS stt, dbo.Car AS car, dbo.ImageCarRent AS img
	WHERE car.id = img.idCar AND car.id = stt.idCar
	AND ((stt.idOwner = @idCustomer AND stt.idRenter <> @idCustomer AND stt.isOwner = 0) OR (stt.idOwner <> @idCustomer AND stt.idRenter = @idCustomer AND stt.isOwner = 0))
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_GetStatusCarByIDCustomerAndIDCar
@idCustomer INT, @idCar INT
AS
BEGIN
	SELECT cus.id, car.licensePlates, ctr.timeIn, ctr.timeOut, stt.idRenter
	FROM dbo.ContractRent AS ctr, dbo.StatusCar AS stt, dbo.Car AS car, dbo.Customer AS cus
	WHERE ctr.idCar = car.id AND car.id = stt.idCar AND ctr.idCustomer = cus.id
	AND cus.id = @idCustomer AND car.id = @idCar
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_CustomerGetCar
@idCustomer INT, @idCar INT
AS
BEGIN
	UPDATE dbo.StatusCar SET idRenter = @idCustomer, isOwner = 1 WHERE idCar = @idCar AND idOwner = @idCustomer
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_CustomerReturnCar
@idCustomer INT, @idCar INT
AS
BEGIN
	UPDATE dbo.StatusCar SET idRenter = 0, isOwner = 0 WHERE idCar = @idCar AND idRenter = @idCustomer AND idOwner <> 0
	UPDATE dbo.StatusCar SET idRenter = 0, isOwner = 1 WHERE idCar = @idCar AND idRenter = @idCustomer AND idOwner = 0
END
GO
-------------------------------------------------
------------------------------------------------------sửa chữa
CREATE PROC USP_ListOfVehiclesUnderManagement
AS
BEGIN
	SELECT id INTO tableIDCarRent FROM dbo.StatusCar
	WHERE idOwner = 0 OR (idOwner <> 0 AND isOwner = 0)

	SELECT car.id, stt.idOwner, dbo.Customer.fname AS fnameO, dbo.Customer.lname AS lnameO,  stt.idRenter, cus.fname AS fnameR, cus.lname AS lnameR, 
	car.licensePlates, car.type, car.color
	INTO tableListCarRent
	FROM dbo.StatusCar AS stt, dbo.Customer, dbo.Customer AS cus, dbo.Car AS car
	WHERE (stt.idOwner = dbo.Customer.id OR stt.idOwner = 0) AND (stt.idRenter = cus.id OR stt.idRenter = 0)
	AND stt.idCar = car.id AND (stt.idOwner <> stt.idRenter OR stt.idOwner = 0)
	AND stt.id IN (SELECT id FROM tableIDCarRent)
	
	UPDATE dbo.tableListCarRent SET fnameO = N'WORK', lnameO = N'SHOP' WHERE idOwner = 0
	UPDATE dbo.tableListCarRent SET fnameR = N'WORK', lnameR = N'SHOP' WHERE idRenter = 0
	
	SELECT DISTINCT id, idOwner, fnameO, lnameO, idRenter, fnameR, lnameR, licensePlates, type, color
	INTO InfoBasicCarRent
	FROM tableListCarRent

	SELECT inf.id AS [ID Car], idOwner AS [ID Owner], fnameO AS [Fname Owner], lnameO AS [Lname Owner],
	idRenter AS [ID Renter], fnameR AS [Fname Renter], lnameR AS [Lname Renter],
	licensePlates AS [License Plates], type AS [Type], color AS [Color], img.frontCheckIn AS [Front Image], img.backCheckIn AS [Back Image]
	FROM InfoBasicCarRent AS inf, dbo.ImageCarRent AS img
	WHERE inf.ID = img.idCar

	DROP TABLE dbo.tableIDCarRent 
	DROP TABLE dbo.tableListCarRent
	DROP TABLE InfoBasicCarRent
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_ListOfCarCompanies
AS
BEGIN
	WITH tableTemp AS (SELECT car.id, stt.idRenter, cus.fname, cus.lname, car.licensePlates, car.type, car.color
	FROM dbo.Car AS car, dbo.StatusCar AS stt, dbo.Customer AS cus, dbo.ImageCarRent AS img
	WHERE stt.idCar = car.id AND stt.idRenter = cus.id AND img.idCar = car.id AND stt.idOwner = 0
	UNION
	SELECT car.id, stt.idRenter ,fname = 'WORK', fname = 'SHOP', car.licensePlates, car.type, car.color
	FROM dbo.Car AS car, dbo.StatusCar AS stt, dbo.ImageCarRent AS img
	WHERE stt.idCar = car.id AND car.id = img.idCar AND stt.idOwner = 0 AND stt.idRenter = 0)
	SELECT tbl.id AS [ID Car], tbl.idRenter AS  [ID Renter], tbl.fname AS [First Name], tbl.lname AS [Last Name],
	tbl.licensePlates AS [License Plates], tbl.type AS [Type], tbl.color AS [Color],
	img.frontCheckIn AS [Front Image], img.backCheckIn AS [Back Image]
	FROM tableTemp AS tbl, dbo.ImageCarRent AS img
	WHERE tbl.id = img.idCar
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_VehicleListingsCanRented
AS
BEGIN
	WITH tableTemp AS (SELECT car.id, stt.idOwner, cus.fname, cus.lname, car.licensePlates, car.type, car.color
	FROM dbo.Car AS car, dbo.StatusCar AS stt, dbo.Customer AS cus, dbo.ImageCarRent AS img
	WHERE stt.idCar = car.id AND stt.idOwner = cus.id AND img.idCar = car.id AND stt.idRenter = 0
	UNION
	SELECT car.id, stt.idOwner ,fname = 'WORK', fname = 'SHOP', car.licensePlates, car.type, car.color
	FROM dbo.Car AS car, dbo.StatusCar AS stt, dbo.ImageCarRent AS img
	WHERE stt.idCar = car.id AND car.id = img.idCar AND stt.idRenter = 0 AND stt.idOwner = 0)
	SELECT tbl.id AS [ID Car], tbl.idOwner AS  [ID Owner], tbl.fname AS [First Name], tbl.lname AS [Last Name],
	tbl.licensePlates AS [License Plates], tbl.type AS [Type], tbl.color AS [Color],
	img.frontCheckIn AS [Front Image], img.backCheckIn AS [Back Image]
	FROM tableTemp AS tbl, dbo.ImageCarRent AS img
	WHERE tbl.id = img.idCar
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_ListOfVehiclesBeingRented
AS
BEGIN
	SELECT car.id AS [ID Car], stt.idOwner AS [ID Owner], cus.fname AS [First Name], cus.lname AS [Last Name],
	car.licensePlates AS [License Plates], car.type AS [Type], car.color AS [Color],
	img.frontCheckIn AS [Front Image], img.backCheckIn AS [Back Image]
	FROM dbo.Car AS car, dbo.StatusCar AS stt, dbo.Customer AS cus, dbo.ImageCarRent AS img
	WHERE stt.idCar = car.id AND stt.idOwner = cus.id AND img.idCar = car.id AND stt.idOwner <> 0
	
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_ListOfRentedCars
AS
BEGIN
	SELECT car.id AS [ID Car], stt.idRenter AS [ID Owner], cus.fname AS [First Name], cus.lname AS [Last Name],
	car.licensePlates AS [License Plates], car.type AS [Type], car.color AS [Color],
	img.frontCheckIn AS [Front Image], img.backCheckIn AS [Back Image]
	FROM dbo.Car AS car, dbo.StatusCar AS stt, dbo.Customer AS cus, dbo.ImageCarRent AS img
	WHERE stt.idCar = car.id AND stt.idRenter = cus.id AND img.idCar = car.id AND stt.idRenter <> 0 AND stt.isOwner = 0
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_SearchDeleteCarOfCompanyByIDCar
@idCar INT
AS
BEGIN
	SELECT car.licensePlates, car.type, car.color, img.frontCheckIn, img.backCheckIn
	FROM dbo.StatusCar AS stt, dbo.Car AS car, dbo.ImageCarRent AS img
	WHERE stt.idCar = car.id AND car.id = img.idCar AND stt.idOwner = 0 AND stt.idRenter = 0 AND car.id = @idCar
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_DeleteCarOfCompanyByIDCar
@idCar INT
AS
BEGIN
	DELETE dbo.StatusCar WHERE idCar = @idCar
	DELETE dbo.ContractRent WHERE idCar = @idCar
	DELETE dbo.ImageCarRent WHERE idCar = @idCar
	DELETE dbo.car WHERE id = @idCar

END
GO
-------------------------------------------------
------------------------------------------------------




-------------------------------------------------------------------------
------------created
CREATE PROC USP_UnCheckedGetCarByQrCode
@qrCode NVARCHAR(30)
AS
BEGIN
	SELECT car.id, car.licensePlates, car.color, car.type FROM dbo.Car , dbo.Contract, dbo.Customer 
	WHERE dbo.Contract.idCustomer = dbo.Customer.id 
	AND dbo.Contract.idCar = car.id 
	AND dbo.Customer.qrCode = @qrCode
	AND dbo.Contract.timeOut IS NULL
END
GO
-------------------------------------------------
------------------------------------------------------
CREATE PROC USP_CheckedGetCarByIdCar
@idCar INT
AS 
BEGIN
	SELECT car.id, car.licensePlates, car.color, car.type FROM dbo.Car , dbo.Contract, dbo.Customer 
	WHERE dbo.Contract.idCustomer = dbo.Customer.id 
	AND dbo.Contract.idCar = car.id 
	AND car.id = @idCar
	AND dbo.Contract.timeOut IS NOT NULL 
END
GO

---------------------------------------------------------------
--created
CREATE PROC USP_GetListCarUnChecked
AS 
BEGIN
	SELECT car.id, car.licensePlates, car.color, car.type FROM dbo.Car , dbo.Contract, dbo.Customer 
	WHERE dbo.Contract.idCustomer = dbo.Customer.id 
	AND dbo.Contract.idCar = car.id 
	AND dbo.Contract.timeOut IS NULL
END
GO

